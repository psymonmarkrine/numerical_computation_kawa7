# 第4章 行列の固有値問題

## 4.1 固有値と固有ベクトル

### 4.1.1 固有値と固有ベクトル

$n$ 次正方行列 $A$ が与えられているとき、

$$
A x = \lambda x \tag{4.1}
$$

を満たす $\lambda$ を $A$ の固有値 (eigen value)、 $x$ を固有ベクトル (eigen vector) という。
固有値と固有ベクトルを求める問題を固有値問題 (eigen value problem) という。

行列の固有値と固有ベクトルは、行列 $A$ の特徴を表す重要な量である。
第3章ではスペクトル半径が反復法の収束性に重要な意味をもっていた。
特に SOR 法においては、固有値の大きさを正しく推定しないと加速されないことを知った。
理工学においては、よい精度で固有値を求めることを要求される例は枚挙にいとまがない。
行列 $A$ は1次変換を表現するが、 $n$ 次元ベクトル $x$ を1次変換してえられた $A x$ は1つのベクトルである。
$A x$ は、一般にはもとのベクトル $x$ と方向も大きさも違っている。
ところで、 $(4.1)$ の関係は次のことを示している。
すなわち、ある特別なベクトルはその1次変換に対して方向を変えないで、大きさだけが $\lambda$ 倍されて $\lambda x$ となったとすると、その特別なベクトル $x$ が $A$ の固有ベクトルであり、大きさの倍率が固有値 $\lambda$ である。
もとのベクトルが $x = 0$ であれば、 $A x = \lambda x (= 0)$ であるが、 $x = 0$ はあまりに自明であり、何の情報も持たないから、固有ベクトルとは考えない。

固有値および固有ベクトルの定義は $(4.1)$ で与えられる。
$(4.1)$ より、

$$
(A - \lambda I) x = 0 \qquad (I \text{は単位行列}) \tag{4.2}
$$

である。
この式は $x$ を未知数ベクトルとする連立1次方程式と見なすことが出来る。
$x \neq 0$ の解をもつためには係数行列 $A - \lambda I$ の行列式は、

$$
\det(A - \lambda I) = 0 \qquad \text{特性方程式} \tag{4.3}
$$

を満たさねばならない。
もし $\det(A - \lambda I) \neq 0$ ならば、連立1次方程式の$\text{右辺} = 0$ だから、 $x = 0$ 以外の解はもたないからである。
行列式 $\det(A - \lambda I)$ を特性多項式といい、 $(4.3)$ を特性方程式という。
特性多項式は $\lambda$ についての $n$ 次多項式であるから、特性方程式 $(4.3)$ は $\lambda$ についての $n$ 次代数方程式である。
この方程式は、等根を含めて $n$ 個の解があるので、固有値は $n$ 個ある。
この $n$ 個の固有値は (たとえ $A$ が実数行列であっても) 一般には複素数である。
こうして、行列 $A$ の固有値を求めることは、特性方程式の $n$ 個の複素解を求めることと同等である。

> #### ［例 4.1］
>
> 2次正方実行列の固有値
>
> $$
> A = \begin{pmatrix}
>  a & b \\
>  c & d \\
> \end{pmatrix} \qquad (a, b, c, d \text{は実数})
> $$
>
> とすると、特性方程式は
>
> $$
> \det(A - \lambda I) = \det \begin{pmatrix}
>  a - \lambda & b \\
>  c & d - \lambda \\
> \end{pmatrix}
> = \lambda^2 - (a + d) \lambda + a d - b c = 0 \\
> \therefore \quad \lambda_1 = \frac{1}{2} [ (a + d) + \sqrt{D} ], \quad  \lambda_2 = \frac{1}{2} [ (a + d) - \sqrt{D} ]
> $$
>
> 故に固有値は2つあり、判別式 $D = (a - d)^2 + 4bc$ の値により、2つの固有値は共役複素数 $(D < 0)$ 、等しい実数 $(D = 0)$ 、2つの実数 $(D > 0)$ である。
> この例のように、実行列であっても固有値は一般に複素数である。

固有値が得られると、これを $(4.1)$ または $(4.2)$ に代入した連立1次方程式を解くことにより固有ベクトルを求めることが出来る。
固有値は $n$ 個あるから、これを $\lambda_i (1 \leqq i \leqq n)$ とすると、その一つ一つの固有値に対応して固有ベクトル $x_i (1 \leqq i \leqq n)$ がある。
すなわち、 $n$ 個のの固有値と $n$ 個の固有ベクトルは

$$
A x_i = \lambda_i x_i \qquad 1 \leqq i \leqq n \tag{4.4}
$$

を満たす。
$x_i$ を 固有値 $\lambda_i$ に属する (または対応する) 固有ベクトルという。

ところで、 $(4.4)$ を、与えられた $A$ と各々の $\lambda_i$ について $x_i$ を求める連立1次方程式と見なすと、 $\det(A - \lambda_i I) = 0$ であるから、 $x_i$ はただ一つにはきまらない。

行列式が $0$ となるような連立1次方程式は、ベクトル $x_i$ の成分の中のいくつかを与えれば他の成分はきまる。
正確に言えば、 $A - \lambda_i I$ のランク (1次独立な列ベクトルの数) を $r$ とすれば、 $(n - r)$ 個の成分を与えれば、他の $r$ 個の成分はきまる。
そして、必ず $r < n$ である。
すなわち、少なくとも1つの成分は任意である。

その1つの例は、一般に $x_i$ を $(4.4)$ の解とすると、 $c x_i$ もまた $(4.4)$ も解であることである：

$$
A(c x_i) = c A x_i = c \lambda_i x_i = \lambda_i (c x_i)
$$

$\vert x_i \vert = 1$ となるように $c$ を選ぶことを規格化 (normalization) という。

本章では、特性方程式 $(4.3)$ を数値的に解いて固有値 $\lambda_i$ を求め、この $\lambda_i$ を連立1次方程式 $(4.4)$ に代入してこれを解いて、固有ベクトル $x_i$ を求める方法について考える。

> #### ［例 4.2］
>
> 2次正方行列の固有ベクトルを求めてみよう。
> 前例 [例 4.1] により2次正方行列の2つの固有値が与えられる。
> 2つの固有値 $\lambda_1$ 、 $\lambda_2$ に属する固有ベクトルを
>
> $$
> x_i = \begin{pmatrix}
>  x_i \\
>  y_i \\
> \end{pmatrix} \qquad (i = 1, 2)
> $$
>
> と置くと、 $x_i$ を求める方程式 $(4.4)$ は
>
> $$
> \left.
> \begin{aligned}
> (a - \lambda_i) x_i + b y_i = 0 \\
> c x_i + (d - \lambda_i) y_i = 0 \\
> \end{aligned} \right\} \qquad (i = 1, 2)
> $$
>
> である。
>
> $(1)$ $D \neq 0$ のとき、2つの固有値は $\lambda_1 \neq \lambda_2$ である。
> 固有ベクトルは、
> $bc \neq 0$ なら
>
> $$
> x_i = \begin{pmatrix}
>  x_i \\
> - \displaystyle\frac{a - \lambda_i}{b} x_i \\
> \end{pmatrix}
> = \begin{pmatrix}
>  x_i \\
> - \displaystyle\frac{c}{d - \lambda_i} x_i
> \end{pmatrix} \qquad (x_i \neq 0 \text{は任意、} i = 1, 2)
> $$
>
> $\det(A - \lambda_i I) = (a - \lambda_i)(d - \lambda_i) - bc = 0$ より、この2つの表現は等しい。
>
> $bc = 0$ (したがって $a \neq d$ ) なら、 $\lambda_1 = a,\ \lambda_2 = d$ 。
> 固有ベクトルは
>
> $(a)$ $b \neq 0,\ c = 0$ のとき
>
> $$
> x_1 = \begin{pmatrix}
>  x_1 \\
>  0 \\
> \end{pmatrix}, \quad x_2 = \begin{pmatrix}
>  x_2 \\
> - \displaystyle\frac{a - d}{b} x_2 \\
> \end{pmatrix} \quad (x_1, x_2 \neq 0 \text{は任意})
> $$
>
> $(b)$ $b = 0,\ c \neq 0$ のとき
>
> $$
> x_1 = \begin{pmatrix}
>  x_1 \\
>  \displaystyle\frac{c}{a - d} x_1 \\
> \end{pmatrix}, \quad x_2 = \begin{pmatrix}
>  0 \\
>  y_2 \\
> \end{pmatrix} \quad (x_1, y_2 \neq 0 \text{は任意})
> $$
>
> $(c)$ $b = c = 0$ のとき
>
> $$
> x_1 = \begin{pmatrix}
>  x_1 \\
>  0 \\
> \end{pmatrix}, \quad x_2 = \begin{pmatrix}
>  0 \\
>  y_2 \\
> \end{pmatrix} \quad (x_1, y_2 \neq 0 \text{は任意})
> $$
>
> このように、 $\lambda_1 \neq \lambda_2 (D \neq 0)$ のときは、 $x_1$ と $x_2$ は1次独立である。
>
> $(2)$ $D = 0$ のとき、 $\lambda_1 = \lambda_2 = \frac{1}{2} (a + d)$ であり、 $bc \neq 0$ (故に $a \neq d$ ) なら
>
> $$
> x_i = \begin{pmatrix}
>  x_i \\
> - \displaystyle\frac{a - d}{2b} x_i \\
> \end{pmatrix} = \begin{pmatrix}
>  x_i \\
>  \displaystyle\frac{2c}{a - d} x_i \\
> \end{pmatrix} \quad ( x_i \neq 0 \text{は任意、} i = 1, 2)
> $$
>
> この2つの表現は、 $\det(A - \lambda I) = - \frac{1}{4} (a - d)^2 - bc = 0$ より等しい。
>
> そして、 $x_1$ と $x_2$ は比例して1次従属である。
>
> $bc = 0$ (故に $a = d$ ) なら
>
> $(a)$ $b \neq 0,\ c = 0$ のとき
>
> $$
> x_1 = \begin{pmatrix}
>  x_1 \\
>  0 \\
> \end{pmatrix}, \quad x_2 = \begin{pmatrix}
>  x_2 \\
>  0 \\
> \end{pmatrix} (x_1, x_2 \neq 0 \text{は任意})
> $$
>
> $(b)$ $b = 0,\ c \neq 0$ のとき
>
> $$
> x_1 = \begin{pmatrix}
>  0 \\
>  y_1 \\
> \end{pmatrix}, \quad x_2 = \begin{pmatrix}
>  0 \\
>  y_2 \\
> \end{pmatrix} (y_1, y_2 \neq 0 \text{は任意})
> $$
>
> $(c)$ $b = c = 0$ のとき ( $A$ は単位行列の $a$ 倍のとき！)、方程式 $(4.4)$ は $0=0$ であり、 $x_i$ も $y_i$ も任意である。
> つまり、このときは、任意の2次元ベクトルは固有ベクトルであり、 $x_1$ と $x_2$ は1次独立になるように選ぶことが可能になる。
>
> このように $\lambda_1 = \lambda_2 (D = 0)$ の場合、 $(c)$ の単位行列の固有値倍である特別な場合を除いて $x_1$ と $x_2$ は1次従属である。
>
> この簡単な例は、固有値と固有ベクトルの特徴をほとんど尽くしている。
> すなわち、相異なった固有値に属する固有ベクトルは、すべて1次独立である ( $(1)$ の場合)。
> 重複固有値に属する固有ベクトルは、1次独立に選ぶことができる場合 ( $(2)(c)$ の場合) と出来ない場合 ( $(2)(a)$ および $(2)(b)$ ) がある。

### 4.1.2 相似変換と固有値・固有ベクトル

任意の行列 $A$ に対して、ある行列 $P$ を使って

$$
A^\prime = P^{-1} A P \tag{4.5}
$$

をつくることを相似変換という。
相似変換された行列 $A^\prime$ の固有値は、特性方程式

$$
\det(P^{-1} A P - \lambda I) = 0
$$

から定まる。
ところが<sup>[$1)$](#note1)</sup>

> <small id="note1">$^{1)}$ $\det(AB) = \det A \cdot \det B$ 。これより、 $\det A^{-1} \cdot \det A = 1$</small>

$$
\begin{aligned}
\det(P^{-1} A P - \lambda I) & = \det[ P^{-1} (A - \lambda I) P ] \\
& = \det P^{-1} \cdot \det(A - \lambda I) \cdot \det P = \det(A - \lambda I) \\
\end{aligned}
$$

であるから、 $P^{-1} A P$ の固有値は $A$ の固有値と同じである。
一般の大行列の行列式の数値計算は困難であるが、相似変換によって固有値が変わらないことを利用して、与えられた行列 $A$ を相似変換によって行列式を計算し易い形の行列に相似変換すれば、固有値を容易に求めることが出来る。

一方、固有ベクトルは相似変換によって変換されてしまい、不変ではない。
$P^{-1} A P$ の固有値 $\lambda$  に属する固有ベクトルを $y$ とすると

$$
P^{-1} A P y = \lambda y
$$

である。
両辺に $P$ を乗じて

$$
A P y = \lambda P y \qquad \text{すなわち} \qquad A(P y) = \lambda (P y)
$$

となるが $(4.1)$ と比べると、 $A$ の固有ベクトル $x$ は

$$
x = P y \tag{4.6}
$$

である。
したがって、 $P^{-1} A P$ の固有ベクトル $y$ を求めたら、 $(4.6)$ によって $A$ の固有ベクトル $x$ を求めることが出来る。

こうして、固有値と固有ベクトルを求め易い行列に相似変換して、固有値問題を解くことが以下の問題になる。

### 4.1.3 三角行列への相似変換

線形代数の基本定理に、次のような定理がある。

***

$\text{シュールの定理}$

任意の複素正方行列 $A$ は、ユニタリ行列 $U$ によって三角行列 $S$ に相似変換出来る<sup>[$2)$](#note2)</sup> 。

$$
U^{-1} A U = S \tag{4.7}
$$

***

この定理をシュール (Schur) の定理という。
行列の固有値問題にとって重要なので、問題 4-1 で証明されている。

> <small id="note2">$^{2)}$ ユニタリ行列とは、 $U H　U = U U H = I$ であるような行列である。
> ただし、 $U H$ は $U$ のエルミート共役行列 (転置して複素共役をとった行列) である。
> ユニタリ行列の逆行列は、そのエルミート共役行列である： $U^{-1} = U H$ 。
> また、実ユニタリ行列は直交行列である。
> エルミート行列とは $H H = H$ であるような行列である。
> 対称行列は実エルミート行列である。</small>

***

#### 例題 4.1

次を証明せよ。

$(1)$ エルミート行列 $H$ は、ユニタリ行列 $U$ によって対角化出来る：

$$
U^H H U = D \qquad D = \text{diag}(\lambda_1, \lambda_2, \cdots \lambda_n)
$$

$(2)$ 実対称行列 $S$ は、直交行列 $R$ によって対角化出来る：

$$
R^\top S R = D, \qquad D = \text{diag}(\lambda_1, \lambda_2, \cdots , \lambda_n)
$$

ここに、 $\lambda_1, \lambda_2, \cdots , \lambda_n$ は $H$ または $S$ の固有値で、全部実数である。

#### ［解］

$(4.7)$ より

$(1)$ $S$ を三角行列として $U^H H U = S$ と置くと

$$
S^H = (U^H H U)^H = U^H H^H U = U^H H U = S
$$

故に三角行列 $S$ は実は実数を対角要素とする対角行列 $D$ である。
相似変換によって固有値は変わらず、対角行列の固有値は対角要素であるから、

$$
S = D = \text{diag}(\lambda_1, \lambda_2, \cdots , \lambda_n)
$$

である。

$(2)$ 実対称行列は実エルミート行列であり、直交行列は実ユニタリ行列であることから明かである。

***

特に $(2)$ は、4.3 節ヤコビ法の理論的根拠である。

シュールの定理によれば、任意の行列はユニタリ変換によって三角行列に相似変換できる。
三角行列の固有値は対角要素そのものであるから、ユニタリ変換さえ見つかれば固有値は求められる。
ただし、ユニタリ変換を見つけるときに注意しなければならないことは、代数学の定理<sup>[$3)$](#note3)</sup> によると、5次以上の代数方程式は有限回の代数演算 (加減乗除とベキ乗根の演算) では解けないことが知られている。
このことは、5次以上の行列のユニタリ変換を見つけるには、理論的には無限回演算が必要であること、数値計算上は無限回反復を意味する<sup>[$4)$](#note4)</sup> 。

> <small id="note3">$^{3)}$ ガロア (Galois) の理論またはアベル (Abel) の定理</small>
>
> <small id="note4">$^{4)}$ 数値計算上では、数値がある許容誤差以内に納まれば、反復を停止すればよいが。</small>

次に注意しなければならないことは、理工学に現れる行列の多くは実行列であり、本書でも固有値問題を解くべき行列を実行列に限ることである。
このとき、特性方程式の係数は実数である。
しかし、実数係数の特性方程式の解である固有値は、実数または複素共役な複素数の組である<sup>[$5)$](#note5)</sup> 。
また、シュールの定理のユニタリ行列 $U$ は一般に複素行列であるが、直交行列 (実ユニタリ行列) に限定すれば、直交変換によっては三角行列に変換できなくて、対角線上に1次または2次小行列が並ぶブロック三角行列 (4.8 節図 4.14 参照) に変換される。
このことは、後の 4.8 節の QR 法、ダブル QR 法でもふれる。

> <small id="note5">$^{5)}$ 実数係数の多項式を $f(x)$ とすると、 $f(x) = 0$ ならば $f(x^*) = 0$ である。
> ただし、 $x^*$ は $x$ の複素共役。</small>

### 4.1.4 対角化可能な行列

$P^{-1} A P$ が対角行列であるような $P$ が存在するとき、 $A$ は対角化可能であるという。
一方、例題 4.1 で示したように、実行列の中でも実対称行列は、固有値も固有ベクトルも全部実数である。
そして、理論的には無限回反復が必要であるが、対角化可能である。
実対称行列か否かは、その行列を見ればすぐわかる。
実数の範囲の演算で対角化可能な実行列には、実対称行列の他に、固有値がすべて実数でかつ相異なるような行列がある。
しかし、この場合は、固有値がすべて異なる実数であることがわかっていなければならない。
また、問題 4-2 に示したように、正規行列<sup>[$6)$](#note6)</sup> は対角化可能である。

> <small id="note6">$^{6)}$ $A^H A = A A^H$ である行列 $A$ を正規行列という。
> エルミート行列、ユニタリ行列、実対称行列、直交行列は正規行列である。</small>

行列を見ただけではわかりにくいが、 $n$ 個すべての固有ベクトル $x_i (1 \leqq i \leqq n)$ が1次独立である時は、 $A$ は対角化可能である<sup>[$7)$](#note7)</sup> 。
このことは、次のようにしてわかる。
$n$ 個の固有ベクトル (列ベクトル) $x_i$ を並べて、

$$
P = (\ x_1\ x_2\ \cdots\ x_n\ ) \tag{4.8}
$$

と置く。
そうすると

$$
\begin{aligned}
A P & = A (\ x_1\ x_2\ \cdots\ x_n\ ) \\
 & = (\ A x_1\ A x_2\ \cdots\ A x_n\ ) \\
 & = (\ \lambda_1 x_1 \lambda_2 x_2 \cdots\ \lambda_n x_n\ ) \\
 & = (\ x_1\ x_2\ \cdots\ x_n\ ) \varLambda \\
 & = P \varLambda \\
\end{aligned}
$$

ただし、 $\varLambda = \text{diag} \{ \lambda_1, \lambda_2, \cdots , \lambda_n \}$ は、 $\lambda_1, \lambda_2, \cdots , \lambda_n$ を対角要素とする対角行列である。
$x_1, x_2, \cdots , x_n$ は1次独立であるから $\det P \neq 0$ であり、 $P^{-1}$ が存在する。
したがって、 $P^{-1} A P = \varLambda$ であり、対角化可能である。

> <small id="note7">$^{7)}$ 逆に、対角化可能な行列には 1 次独立な固有ベクトルが存在する。</small>

> #### ［例 4.3］
>
> [例 4.2] の2行2列の行列の例で、2つの1次独立な固有ベクトルが存在するとき、相似変換行列 $P$ を $P = (\ x_1\ x_2\ )$ とおけば、対角化可能である。
> 例えば、 $a = 1$ 、 $b = 2$ 、 $c = 3$ 、 $d = 4$ としたとき、 $(D = 33 \neq 0$ 、 $bc = 6 \neq 0)$
>
> $$
> \begin{aligned}
> & \det(A - \lambda I) = \lambda^2 - 5 \lambda - 2 = 0, \quad \therefore \quad \lambda_1 = \frac{1}{2} (5 + \sqrt{33}), \quad \lambda_2 = \frac{1}{2} (5 - \sqrt{33}) \\
> & P = (\ x_1\ x_2\ ) = \begin{pmatrix}
>  4 & 4 \\
>  3 + \sqrt{33} & 3 - \sqrt{33} \\
> \end{pmatrix}, \quad P^{-1} = \begin{pmatrix}
> \displaystyle\frac{-3 + \sqrt{33}}{8 \sqrt{33}} & \displaystyle\frac{1}{2 \sqrt{33}} \\
> \displaystyle\frac{3 + \sqrt{33}}{8 \sqrt{33}} & \displaystyle\frac{-1}{2 \sqrt{33}} \\
> \end{pmatrix} \\
> & \therefore \quad P^{-1} A P = \begin{pmatrix}
>  \frac{1}{2} (5 + \sqrt{33}) & 0 \\
>  0 & \frac{1}{2} (5 - \sqrt{33}) \\
> \end{pmatrix} = \begin{pmatrix}
>  \lambda_1 & 0 \\
>  0 & \lambda_2 \\
> \end{pmatrix} = \varLambda
> \end{aligned}
> $$

### 4.1.5 ジョルダンの標準形

$n$ 個の固有ベクトルが1次独立でないことがおこるのは、 $n$ 個の固有値の中に重複固有値が存在する時のみである ([例 4.2] 参照)。
一方、シュールの定理によれば、任意の正方行列はユニタリ変換によって三角行列に変換できる。
対角行列に最も近い三角行列としては、ジョルダン (Jorda_n) の標準形と呼ばれる次の三角行列がある。

$$
J = \begin{pmatrix}
    J_1 \\
    & J_2 & & & \Large{0} \\
    & & \ddots \\
    & & & J_i \\
    & \Large{0} & & & \ddots \\
    & & & & & J_r \\
\end{pmatrix}, \quad J_i = \begin{pmatrix}
    \lambda_i & 1 \\
    & \lambda_i & 1 & \Large{0} \\
    & & \lambda_i & \ddots \\
    & \Large{0} & & \ddots & 1 \\
    & & & & \lambda_i \\
\end{pmatrix} \tag{4.9}
$$

ここに、 $J_i (1 \leqq i \leqq r)$ は、ジョルダン細胞と呼ばれ、対角要素が固有値 $\lambda_i$ 、上副対角要素が $1$ である $n_i$ 次小行列である。
もちろん、 $n_1 + n_2 + \cdots + n_r = n$ である。
特に、 $n_i = 1$ の時は $J_i$ は対角要素のみの1行1列の行列と見なし、したがって、すべての $n_i = 1$ なら $J$ は対角行列である。
このとき、次の定理がある。

***

$\text{定理 (ジョルダンの標準形)}$

すべての $n$ 次正方行列 $A$ は、ある $P$ によって $P^{-1} A P = J$ とジョルダンの標準形に相似変換できる。

***

ただし、この定理の $P$ は、一般には複素数行列であるが、ユニタリ行列とは限らない。
また、固有値は一般には複素数で、複数のジョルダン細胞の固有値が等しいこともある。
この定理の証明は、線形代数学の教科書を参照されたい<sup>[$8)$](#note8)</sup> 。
ここでは、対角化できない行列の実例を示す。

> <small id="note8">$^{8)}$ 例えば 川上一郎「ジョルダン標準形」http://www7.ocn.ne.jp/~kawa1/difform.pdf </small>

#### ［例 4.4］

[例 4.2] の重複固有値 $(\ \lambda_1 = \lambda_2 = a = d,\ b \neq 0,\ c = 0\ )$ の場合、固有ベクトル $x_1$ と $x_2$ は1次従属であるから、 $P = (\ x_1\ x_2\ )$ とすると、 $\det P = 0$ となって $P^{-1}$ は存在しない。
そこで、1つの固有ベクトルを $x_1 = (\ 1\ 0\ )^\top$ ととって、 $x_2$ は $x_1$ とは1次独立なベクトルであるように、 $x_2 = (\ x\ y\ )^\top$ と置く（ $x$ と $y$ は以下決める ）。
このとき、

$$
P = (\ x_1\ x_2\ ) = \begin{pmatrix}
 1 & x \\
 0 & y \\
\end{pmatrix} \qquad \therefore \quad P^{-1} = \begin{pmatrix}
 1 & - \frac{x}{y} \\
 0 & \frac{1}{y} \\
\end{pmatrix} \qquad (y \neq 0)
$$

故に

$$
P^{-1} A P = \begin{pmatrix}
 a & b y \\
 0 & a \\
\end{pmatrix}
$$

である。
$\det P = y \neq 0$ より $y \neq 0$ であるから、 $b \neq 0$ より $P^{-1} A P$ は対角行列ではない。
とくに、 $y = 1 / b$ とおけば、 $P^{-1} A P$ は、ジョルダン細胞である。
( なお、 $x$ は任意だから、 $x = 0$ としてもよい。)

### 4.1.6 固有値問題の数値解法

以上の考察から、実行列の固有値問題の数値解法の方針は、次のようになる。

$(1)$ 実対称行列については、直交変換で対角化して固有値と固有ベクトルを求める方法を考察する。
これは、最も古典的な方法であるヤコビ法 (4.3 節) である。

$(2)$ 一般の実行列 (実対称行列を含む) に対しては、三重対角行列またはヘッセンベルグ行列への直交行列を用いた相似変換を行って、簡単化された行列の固有値問題に直して、それを解く。

まず、準備として、対角行列、三重対角行列、ヘッセンベルグ行列の行列式の求め方について述べる。
その後で、相似変換のための直交行列を求め、簡単化された固有値問題を解く。

## 4.2 簡単な行列の固有値計算

### 4.2.1 対角行列・三角行列の行列式

固有値を求めることは、代数方程式である特性方程式 $(4.3)$ の解を求めることである。
そのためには、 $n$ 次行列式を計算する必要がある。
一般に $n$ が大きい $n$ 次行列式を数値計算することは非常に手間がかかり、しかも精度が悪い。

行列が簡単な形の場合には、行列式の計算も簡単である。
行列式が求めやすい行列の形としては、非対角要素が全部 $0$ である対角行列 (diagonal matrix) がある。
対角行列 $D$ の対角要素 (diagonal element) を $a_{11}, a_{22}, \cdots , a_{nn}$ とすると、対角行列は

$$
D = \begin{pmatrix}
    a_{11} \\
    & a_{22} & & & \Large{0} \\
    & & a_{33} \\
    & & & \ddots \\
    & \Large{0} & & & \ddots \\
    & & & & & a_{nn} \\
\end{pmatrix} \qquad 対角行列 \tag{4.10}
$$

であり、対角行列 $D$ の特性方程式は、

$$
\det(D - \lambda I) = (a_{11} - \lambda)(a_{22} - \lambda) \cdots (a_{nn} - \lambda) = 0
$$

であるから、固有値は

$$
\lambda_1 = a_{11}, \lambda_2 = a_{22}, \cdots , \lambda_n = a_{nn}
$$

と立ちどころに求めることができる。
すなわち、対角行列の固有値は対角要素である。

もう少し一般的で固有値の求め易い行列は、対角要素の下の要素が $0$ である上三角行列 (upper tria_ngular matrix)、対角要素の上の要素が $0$ である下三角行列 (lower tria_ngular matrix) である。
これらの三角行列 $S$ は

$$
S = \begin{pmatrix}
a_{11} & a_{12} & a_{13} & \cdots & a_{1n} \\
& a_{22} & a_{23} & \cdots & a_{2n} \\
& & a_{33} & \cdots & a_{3n} \\
& \Large{0} & & \ddots & \vdots \\
& & & & a_{nn} \\
\end{pmatrix} \qquad \text{上三角行列} \tag{4.11}
$$

$$
S = \begin{pmatrix}
a_{11} \\
a_{21} & a_{22} & & \Large{0} \\
a_{31} & a_{32} & a_{33} \\
\vdots & \vdots & \vdots & \ddots \\
a_{n1} & a_{n2} & a_{n3} & \cdots & a_{nn} \\
\end{pmatrix} \qquad \text{下三角行列} \tag{4.12}
$$

の形をしている。
特性方程式は上三角行列も下三角行列も同じで、

$$
\det(S - \lambda I) = (a_{11} - \lambda)(a_{22} - \lambda) \cdots (a_{nn} - \lambda) = 0
$$

であり、対角行列の時と同じく、固有値は対角要素である。
なお対称な三角行列は対角行列である。

以上の対角行列と三角行列は、行列式の計算も容易どころか、行列式の計算はするまでもなく固有値が求められてしまっている。

### 4.2.2 三重対角行列の行列式

次にもう少し一般的で、行列式の計算が容易な行列は

$$
T = \begin{pmatrix}
    a_{11} & a_{12} \\
    a_{21} & a_{22} & a_{23} & & \Large{0} \\
    & a_{32} & a_{33} & \ddots \\
    & & a_{43} & \ddots & a_{n-2\ n-1} \\
    & \Large{0} & & \ddots & a_{n-1\ n-1} & a_{n-1\ n} \\
    & & & &a_{n\ n-1} & a_{n\ n} \\
\end{pmatrix} \tag{4.13}
$$

という形をしている三重対角行列 (tridiagonal matrix) である。
三重対角行列は、対角要素とその隣の要素以外は $0$ であるような行列である。
対角要素の隣の要素を副対角要素 (subdiagonal element) という。

三重対角行列の特性方程式は、対角行列や三角行列のようには簡単ではないが、うまい計算方法がある。
三重対角行列を $T$ とすると、 $T - \lambda I$ も三重対角行列である。
まず1次行列 $T_1 - \lambda I$ から出発して、2次、3次、 $\cdots$ の小行列を図 4.1 のようにつくる。
それぞれの行列を $T_1 - \lambda I, T_2 - \lambda I, \cdots , T_n - \lambda I$ と書く<sup>[$9)$](#note9)</sup> 。
さらに、各行列式を

$$
\begin{array}{ll}
d_1 & = \det(T_1 - \lambda I) = a_{11} - \lambda \\
d_2 & = \det(T_2 - \lambda I) \\
 & \quad \cdots \, \cdots \\
d_{n-1} & = \det(T_{n-1} - \lambda I) \\
d_n & = \det(T_n - \lambda I) = \det(T - \lambda I) \\
\end{array}
$$

と書くと、次の関係があることは図 4.1 からすぐ わかる。

$$
\begin{array}{ll}
d_0 & = 1 \\
d_1 & = (a_{11} - \lambda) \\
d_2 & = (a_{22} - \lambda) d_1 - a_{12} a_{21} d_0 \\
 & \quad \cdots \, \cdots \\
d_k & = (a_{kk} - \lambda) d_{k-1} - a_{k-1\ k} a_{k\ k-1} d_{k-2} \\
 & \quad \cdots \, \cdots \\
d_{n-1} & = (a_{n-1\ n-1} - \lambda) d_{n-2} - a_{n-2\ n-1} a_{n-1\ n-2} d_{n-3} \\
d_n & = (a_{nn} - \lambda) d_{n-1} - a_{n-1\ n} a_{n\ n-1} d_{n-2} \\
\end{array} \tag{4.14}
$$

この関係を順にたどって行けば、目的とする $d_n = \det(T - \lambda I)$ が求められる。

> <small id="note8">$^{9)}$ ここで単位行列 $I$ は1次、2次、 $\cdots$ であるから $I_1 , I_2 , \cdots$ と次数を明示すべきであろうが、混乱することもないので、全部 $I$ と書く。
> $I_1 = 1$ である。</small>

### 4.2.3 スツルムの定理

実対称行列の固有値は実数である。
さらに実対称行列が三重対角であれば、固有値はすべて異なる10) 。
そして、行列式が上のように簡単に求められるだけではなく、固有値自身も容易に求められる。
それは、 $d0, - d1, d2, - d3, \cdots , (-1)^n d_n$ を固有値 $\lambda$ の関数の列と見なしたとき、スツルムの関数列と呼ばれる関数列になっているからである。

$\lambda$ の関数の列 $( f_0 (\lambda), f_1 (\lambda), \cdots f_{n-1} (\lambda), f_n (\lambda) )$ が次の4つの条件を満足するとき、スツルムの関数列という：

***

$(1)$ $f_0 (\lambda)$ の符号は一定である。

$(2)$ ある $\lambda$ に対して、連続した2つの関数 $(f_k (\lambda), f_{k+1} (\lambda))$ は同時には $0$ にならない。

$(3)$ ある $\lambda$ で $f_k (\lambda) = 0$ ならば、 $f_{k-1} (\lambda)$ と $f_{k+1} (\lambda)$ は逆符号である。

$(4)$ $f_k (\lambda) = 0$ ならば、 $f_k^{\prime} (\lambda)$ と $f_{k-1} (\lambda)$ の符号は同じである。

***

ところで、実対称3重対角行列の場合、 $f_k (\lambda) = (-1)^k d_k$ と置けば、 $f_k (\lambda) (k = 0, 1, 2, 3, \cdots , n - 1, n)$ は、

$$
\begin{array}{ll}
f_0 & = 1, \\
f_1 & = \lambda - a_{11}, \\
f_2 & = (\lambda - a_{22}) f_1 - a_{21}^2 f_0, \\
\cdots & \quad \cdots \\
f_{k-1} & = (\lambda - a_{k-1\ k-1}) f_{k-2} - a_{k-1\ k-2}^2 f_{k-3}, \\
f_k & = (\lambda - a_{kk}) f_{k-1} - a_{k\ k-1}^2 f_{k-2}, \\
f_{k+1} & = (\lambda - a_{k+1\ k+1}) f_k - a_{k+1\ k}^2 f_{k-1}, \\
\cdots & \quad \cdots \\
f_{n-1} & = (\lambda - a_{n-1\ n-1}) f_{n-2} - a_{n-1\ n-2}^2 f_{n-3}, \\
fn & = (\lambda - a_{nn}) f_{n-1} - a_{n\ n-1}^2 f_{n-2} \\
\end{array} \tag{4.15}
$$

であるが、これがスツルムの関数列をなすことは、次のようにして示される。

***

$(1)$ $f_0 (\lambda) = 1$ は定符号である。

$(2)$ もしある $\lambda$ に対して $f_k (\lambda)$ と $f_{k-1} (\lambda)$ が $0$ になったら、 $f_{k-2} (\lambda)$ も $0$ である。
これを繰り返すと $f_0 (\lambda)$ も $0$ となり、 $f_0 (\lambda) = 1$ と矛盾する。

$(3)$ $f_k (\lambda) = 0$ ならば、 $f_{k+1} (\lambda) = -a_{k+1\ k}^2 f_{k-1} (\lambda)$ であるから、 $f_{k+1} (\lambda)$ と $f_{k-1} (\lambda)$ はお互いに逆符号である。

$(4)$ まず、 $f_k (\lambda)$ とその微分は

$$
\begin{aligned}
& f_k = (\lambda - a_{kk}) f_{k-1} - a_{k\ k-1}^2 f_{k-2} \\
& f_k^{\prime} = (\lambda - a_{kk}) f_{k-1}^{\prime} + f_{k-1} - a_{k\ k-1}^2 f_{k-2}^{\prime}
\end{aligned}
$$

この2式の右辺第1項を消去して

$$
f_{k-1}f_k^{\prime} - f_{k-1}^{\prime} f_k = f_{k-1}^2 + a_{k\ k-1}^2 \{ f_{k-2} f_{k-1}^{\prime} - f_{k-2}^{\prime} f_{k-1} \}
$$

$k$ を $k - 1, k - 2, \cdots , 3, 2$ と繰り返せば、 $k = 2$ のとき

$$
f_1 f_2^{\prime} - f_1^{\prime} f_2 = f_1^2 + a_{21}^2 \{ f_0 f_1^{\prime} - f_0^{\prime} f_1 \} = (\lambda - a_{11})^2 + a_{21}^2 > 0
$$

これを $k = 3, 4, \cdots$ と逆に繰り返せば、

$$
f_{k-1} f_k^{\prime} - f_{k-1}^{\prime} f_k > 0
$$

このとき、 $f_k(\lambda) = 0$ ならば

$$
f_{k-1} f_k^{\prime} > 0
$$

すなわち、 $f_k(\lambda) = 0$ ならば $f_k^{\prime} (\lambda)$ は $f_{k-1} (\lambda)$ と同符号である。

***

ある $\lambda$ について、スツルムの関数列の符号変化の回数を $\text{NCS}(\lambda)$ とする。
例えば $n = 5, \lambda = 3$ としたとき、

$$
f_0 (3) = 1, f_1 (3) = -4, f_2 (3) = 0, f_3 (3) = 3, f_4 (3) = -2, f_5 (3) = -7
$$

ならば、符号変化 $+-0+--$ の回数は $\text{NCS}(3) = 3$ である。
なお、 $-0+$ 、 $+0-$ の符号変化の回数はどちらも1回と数える。
このとき、符号変化回数 $\text{NCS}(\lambda)$ と $f_n (\lambda) = 0$ の実数解の個数の間に次のスツルム (Sturm) の定理がある。

***

$\text{スツルムの定理}$

$f_n (a) \neq 0$ 、 $f_n (b) \neq 0$ とする。
範囲 $a < \lambda < b$ における $f_n (\lambda) = 0$ の実数解の個数は $\text{NCS}(a) - \text{NCS}(b)$ である。

***

もちろん、 $f_n(a) = 0$ ならば $a$ は解であり、 $f_n(b) = 0$ ならば $b$ は解である。
次に例を示す。

#### ［例 4.5］

対角要素が $2$ で、副対角要素が $1$ である $n$ 次三重対角実対称行列の固有値は

$$
\lambda_k = 4 \cos^2 \left[ \frac{k\pi}{2(n + 1)} \right] \qquad k = 1, 2, \cdots , n
$$

である (問題 4-15 参照)。
ここでは、 $n = 5$ とする。
このときの固有値は

$$
\lambda_1 = 3.732050 \cdots ,\ \lambda_2 = 3,\ \lambda_3 = 2,\ \lambda_4 = 1,\ \lambda_5 = 0.267949192 \cdots
$$

である。
一方、行列式の特性方程式から作ったスツルム関数列の符号変化回数を求てみると表のようになる。 (小数点以下2桁目を4捨5入)

| $\lambda$                      | 0.0 | 0.5 | 1.0 | 2.0 | 3.0 | 3.5 | 4.0 |
| :---                           | --: | --: | --: | --: | --: | --: | --: |
| $f_0 = 1$                      | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 |
| $f_1 = \lambda - 2$            | -2.0 | -1.5 | -1.0 | 0.0 | 1.0 | 1.5 | 2.0 |
| $f_2 = (\lambda - 2)f_1 - f_0$ | 3.0 | 1.3 | 0.0 | -1.0 | 0.0 | 1.3 | 3.0 |
| $f_3 = (\lambda - 2)f_2 - f_1$ | -4.0 | -0.4 | 1.0 | 0.0 | -1.0 | 0.4 | 4.0 |
| $f_4 = (\lambda - 2)f_3 - f_2$ | 5.0 | -0.7 | -1.0 | 1.0 | -1.0 | -0.7 | 5.0 |
| $f_5 = (\lambda - 2)f_4 - f_3$ | -6.0 | 1.4 | 0.0 | 0.0 | 0.0 | -1.4 | 6.0 |
| $\text{符号変化回数 (NCS)}$     | 5 | 4 | (3) | (2) | (1) | 1 | 0 |
| $\text{固有値の数}$             | 1 | 1 | 1 | 1 | 1 |

この表から、固有値は $0 < \lambda < 0.5$ の間に1個、 $\lambda = 1, \lambda = 2, \lambda = 3$ は $f_5 = 0$ であるから固有値、 $3.5 < \lambda < 4$ の間に1個あることがわかる。
この数は固有値の数と一致している。
なお、 $\lambda = 1, 2, 3$ のときの符号変化の回数はここでは問題にしない。

この場合、 $(f_0, f_1, \cdots , f_5)$ は図 4.2 の通りである。
実際、この図の場合スツルムの定理の成り立つことを示す。
以下、 $f_k(\lambda) = 0$ の解を $\alpha_1^{(k)} , \alpha_2^{(k)} , \cdots$ と書く。

***

$(a)$ スツルムの関数列の性質 $(1)$ は $f_0(\lambda) = 1$ は定符号であることより明らかである。

$(b)$ $f_0(\lambda) = 1 > 0$ で $f_1^{\prime}(\lambda) = 1 > 0$ であるから、性質 $(4)$ は満たされている。
そうして、 $f_1(\lambda) = \lambda - a_{11} = 0$ の解は $\lambda = a_{11} = \alpha^{(1)}$ であるから、関数列 $(f_0 , f_1)$ の符号変化回数は、解の左側 $(\lambda < \alpha^{(1)})$ では1回、右側 $(\lambda \geqq \alpha^{(1)})$ では 0 回
である。

$(c)$ $f_2(\lambda) = 0$ の解は、性質 $(2)$ より $f_1(\lambda) = 0$ の解と一致することはない。
そして、 $f_2^{\prime}(\lambda)$ の符号は $f_1(\lambda)$ の符号と同じであるから、 $f_2(\lambda)$ は $\alpha_1^{(1)}$ の左では減少関数、右では増加関数である。
したがって、解 $\alpha_1^{(2)}$ は $\alpha_1^{(1)}$ の左側にあり、 $\alpha_2^{(2)}$ は右側にあることになる。
すなわち、 $\alpha_1^{(2)} < \alpha_1^{(1)} < \alpha_2^{(2)}$ である。
また符号変化の回数は、 $\alpha_1^{(2)}$ 、 $\alpha_2^{(2)}$ それぞれの左側では1回増加し右側では変わらず、その結果、 $(f_0, f_1, f_2)$ の符号変化回数は $\lambda < \alpha_1^{(2)}$ では2回、 $\alpha_1^{(2)} \leqq \lambda < \alpha_2^{(2)}$ では1回、 $\alpha_2^{(2)} \leqq \lambda$では0回である。

$(d)$ 同様に $f_3(\lambda) = 0$ の解と $f_2(\lambda) = 0$ の解は、交互に並び、

$$
\alpha_1^{(3)} < \alpha_1^{(2)} < \alpha_2^{(3)} < \alpha_2^{(2)} < \alpha_3^{(3)}
$$

となる。
符号変化の回数は、最左側では3回、解と解の2つの間ではそれぞれ2回と1回、最右側では0回である。

$(e)$ 同様に、 $k = n = 5$ のとき、最左端、 $f_5(\lambda) = 0$ の5つの解の間および最右端の $(f_0, f_1, f_2, f_3, f_4, f_5)$ の符号変化の回数は、それぞれ5回、4回、3回、2回、1回、0回である。

***

一般に、 $(f_0, f_1, f_2, \cdots , f_{k-1})$ についてスツルムの定理が成立していると仮定する。
$f_k (\lambda) = 0$ の $k$ 個の解 $\alpha_1^{(k)} < \alpha_2^{(k)} < \cdots < \alpha_k^{(k)} はスツルム関数列の性質 $(2)$ より $f_{k-1}(\lambda) = 0$ の解と一致することはなく、また、性質 $(3)$ と $(4)$ より $f_{k-1}(\lambda) = 0$ の解の外側と間に1個づつ存在するから、

$$
\alpha_1^{(k)} < \alpha_1^{(k-1)} < \alpha_2^{(k)} < \alpha_2^{(k-1)} < \cdots < \alpha_{k-1}^{(k-1)} < \alpha_k^{(k)}
$$

のように、 $\alpha_i^{(k)}$ は $\alpha_{i-1}^{(k-1)} と $\alpha_i^{(k-1)}$ の間にある。
そうして、 $(f_0, f_1, \cdots , f_{k-1}, f_k)$ の符号変化の回数は $\alpha_i^{(k)}$ の左側 $(\alpha_{i-1}^{(k-1)} < \lambda < \alpha_i^{(k)})$ では1回増えて $k - i + 1$ 回となり、右側 $(\alpha_i^{(k)} \leqq\lambda < \alpha_i^{(k-1)})$ では変化せず $k - i$ 回のままである。
同様に、 $\alpha_{i+1}^{(k)}$ の左側は1回増えて $k - i$ 回、右側は $k - i - 1$ 回のまま変化がない。
その結果、 $\alpha_i^{(k)} \leqq \lambda < \alpha_{i+1}^{(k)}$ では $k - i$ 回となる。
こうして、 $(f_0, f_1, \cdots , f_{k-1}, f_k)$ の各区間における符号変化回数は

$$
\begin{matrix}
    \begin{array}{rcl}
        & \lambda & < \alpha_1^{(k)} \\
        \alpha_1^{(k)} \leqq & \lambda & < \alpha_2^{(k)} \\
        \alpha_2^{(k)} \leqq & \lambda & < \alpha_3^{(k)} \\
        \cdots & & \cdots \\
        \alpha_{i-1}^{(k)} \leqq & \lambda & < \alpha_i^{(k)} \\
        \cdots & & \cdots \\
        \alpha_{k-1}^{(k)} \leqq & \lambda & < \alpha_k^{(k)} \\
        \alpha_k^{(k)} \leqq & \lambda \\
    \end{array} & 
    \begin{array}{ll}
        \text{では} & k 回 \\
        \text{では} & k - 1 回 \\
        \text{では} & k - 2 回 \\
        \cdots \\
        \text{では} & k - i + 1 回 \\
        \cdots \\
        \text{では} & 1 回 \\
        \text{では} & 0 回 \\
    \end{array}
\end{matrix}
$$

となる。

この関係は、 $k = n$ に対しても成立する。
すなわち、スツルムの定理が証明された。

### 4.2.4 三重対角実対称行列の固有値

区間 $a < \lambda < b$ の中の $f_n(\lambda) = 0$ の解の個数は $\text{NCS}(a) - \text{NCS}(b)$ だから、区間の幅を小さくしていけば、実の固有値 $\lambda$ を必要な精度で求められる。
区間の幅を半分にして行って解を求める方法を2分法 (bisection method) と言う。

まず、三重対角実行列の固有値の存在する範囲は、後で述べるゲルシュゴリンの
定理 (図 4.4 および 問題 4-5 参照) より、

$$
\left.
\begin{matrix}
a = \displaystyle\min_i \{ a_{ii} - \vert a_{i\ i-1} \vert - \vert a_{i\ i+1} \vert \} & 下限 \\
b = \displaystyle\max_i \{ a_{ii} + \vert a_{i\ i-1} \vert + \vert a_{i\ i+1} \vert \} & 上限 \\
\end{matrix}
\right\} \tag{4.16}
$$

である。

大型行列で次数 $n$ が大きいとき、また $\lambda$ が大きいときには、 $f_k (\lambda)$ の計算中にオーバーフローを起こすことがある。
オーバーフローを避けるためには、

$$
g_k(\lambda) = \frac{f_k (\lambda)}{f_{k-1} (\lambda)} \tag{4.17}
$$

なる関数を定義すれば、 $(4.15)$ より

$$
\begin{align}
g_1 = & \lambda - a_{11} \\
g_k = & (\lambda - a_{kk}) - \frac{a_{k\ k-1}^2}{g_{k-1}} & (2 \leqq k \leqq n) \tag{4.18} \\
\end{align}
$$

によって関数列 $g_k(\lambda)$ が求められるから、スツルム関数列の符号変化回数の代わりに 

$$
g_k(\lambda) < 0 \qquad (1 \leqq k \leqq n)
$$

となる回数を数えればよい。
$g_{k-1}(\lambda) = 0$ となる恐れがあるが、そのときには $g_{k-1}(\lambda)$ に小さな正数 (例えば $10^{-10}$ ) を代入しておく。
こうしても符号変化回数には影響を与えない。

<details><summary></summary><div>

図 4.3 に 2 分法の手順の PAD を示す。
範囲を2分割して行き、小区間を増やすごとに変数 $p$ を $1$ 増やす。
固有値が1つになり、かつ幅が十分狭くなった小区間では、初期値を小区間の中点とするニュートン法により固有値をを求め、 `p` を $1$ 減らす。
全部の固有値が求められたら `p = 0` になるから、 `p > 0` の間手順を続ける。
各小区間の下限と上限は、配列要素 `Xsl(p)` と `Xsr(p)` に記憶しておく。
また下限と上限における符号変化回数は、 `Nsl(p)` と `Nsr(p)` に記憶しておく。

</div></details>

### 4.2.5 ヘッセンベルグ行列の行列式

三角行列をやや一般化した形の行列

$$
H = \begin{pmatrix}
    a_{11} & a_{12} & a_{13} & \cdots & \cdots & a_{1n} & \\
    a_{21} & a_{22} & a_{23} & \cdots & \cdots & a_{2n} & \\
    & a_{32} & a_{33} & \cdots & \cdots & a_{3n} & \\
    & & a_{43} & \ddots & & \vdots \\
    & \Large{0} & & \ddots & \ddots & \vdots \\
    & & & & a_{n\ n-1} & a_{nn} \\
\end{pmatrix} \quad 上ヘッセンベルグ 行列 \tag{4.19}
$$

$$
H = \begin{pmatrix}
    a_{11} & a_{12} \\
    a_{21} & a_{22} & a_{23} & & \Large{0} \\
    a_{31} & a_{32} & a_{33} & \ddots \\
    \vdots & \vdots & \vdots & \ddots & \ddots \\
    \vdots & \vdots & \vdots & & \ddots & a_{n-1\ n} \\
    a_{n1} & a_{n2} & a_{n3} & \cdots & \cdots & a_{nn} \\
\end{pmatrix} \quad 下ヘッセンベルグ 行列 \tag{4.20}
$$

をヘッセンベルグ (Hessenberg) 行列という。
ヘッセンベルグ行列の行列式の値は次のようにして求める。
$H$ を上ヘッセンベルグ行列とすれば、 $H - \lambda I$ も上ヘッセンベルグ行列である。
固有値方程式 $(H - \lambda I)x = 0$ を成分で書き下すと

$$
\left. \begin{aligned}
(a_{11} - \lambda) x_1 + a_{12} x_2 + \cdots + a_{1n} x_n & = -F (\lambda) \\
a_{21} x_1 + (a_{22} - \lambda) x_2 + \cdots + a_{2n} x_n & = 0 \\
\cdots \, \cdots \, \cdots \, \cdots & \\
a_{n\ n-1} x_{n-1} + (a_{nn} - \lambda) x_n & = 0 \\
\end{aligned} \right\} \tag{4.21}
$$

第1式の右辺は $-F (\lambda)$ と記した11) 。
$x_n = 1$ として、最後の式より $x_{n-1} を求め、

$$
x_{n-1} = (\lambda - a_{nn}) x_n / a_{n\ n-1}
$$

次に $i = n - 1, n - 2, \cdots , 2$ の順に後の方から $x_i$ を

$$
\begin{aligned}
x_{i-1} & = \left. \left[ (\lambda - a_{ii}) x_i - \sum_{j=i+1}^n a_{ij} x_j \right] \right/ a_{i\ i-1} \\
& = \left. \left[ \lambda x_i - \sum_{j=i}^n a_{ij} x_j \right] \right/ a_{i\ i-1} \quad (n - 1 \geqq i \geqq 2)
\end{aligned}
$$

のように、すでに求めた $x_j$ によって求める公式が得られる。
この $x_1, x_2, \cdots, x_n$ を $F (\lambda)$ (第1式) に代入すると

$$
F (\lambda) = \lambda x_1 - \sum_{i=1}^n a_{1j} x_j \tag{4.22}
$$

となる。

次に、 $F (\lambda)$ は $\det(H - \lambda I)$ に比例することを示そう。

$$
\det(H - \lambda I) = \det \begin{pmatrix}
    a_{11} - \lambda & a_{12} & a_{13} & \cdots & \cdots & a_{1n} \\
    a_{21} & a_{22} - \lambda & a_{23} & \cdots & \cdots & a_{2n} \\
    & a_{32} & a_{33} - \lambda & \cdots & \cdots & a_{3n} \\
    & & \ddots & \ddots & & \vdots \\
    & \Large{0} & & \ddots & \ddots & \vdots \\
    & & & & a_{n\ n-1} & a_{nn} - \lambda \\
\end{pmatrix}
$$

第1列に $x_1$ 、第2列に $x_2$ 、$\cdots$ 第 $n - 1$ 列に $x_{n-1}$ を乗じて、第 $n$ 列 (に $x_n = 1$ を乗じたもの) に加えると、

$$
\begin{align}
\det(H - \lambda I) & = \det \begin{pmatrix}
    a_{11} - \lambda & a_{12} & a_{13} & \cdots & a_{1n-1} & -F (\lambda) \\
    a_{21} & a_{22} - \lambda & a_{23} & \cdots & a_{2n-1} & 0 \\
    & a_{32} & a_{33} - \lambda & \cdots & a_{3n-1} & 0 \\
    & & \ddots & \ddots & & \vdots \\
    & \Large{0} & & \ddots & \ddots & \vdots \\
    & & & & a_{n\ n-1} & 0 \\
\end{pmatrix} \\
& = (-1)^{n+2} F (\lambda) \det \begin{pmatrix}
    a_{21} & a_{22} - \lambda & \cdots & a_{2n-1} \\
    & a_{32} & \cdots & a_{3n-1} \\
    \Large{0} & & \ddots & \vdots \\
    & & & a_{n\ n-1} \\
\end{pmatrix} \\
& = (-1)^n a_{21} a_{32} a_{43} \cdots a_{n\ n-1} F (\lambda) \tag{4.23} \\
\end{align}
$$

下ヘッセンベルグ行列の場合には、 $x_1 = 1$ として

$$
x_{i+1} = \left. \left[ \lambda x_i - \sum_{j=1}^n a_{ij} x_j \right] \right/ a_{i\ i+1} \qquad(1 \leqq i \leqq n - 1)
$$

の順に $x_{i+1}$ を求め、1番下の行 (第 $n$ 行) から

$$
F (\lambda) = \lambda x_n - \sum_{j=1}^n a_{nj} x_j
$$

を計算する。
この $F (\lambda)$ を用いて

$$
\det(H - \lambda I) = (-1)^n a_{12} a_{23} a_{34} \cdots a_{n-1\ n} F (\lambda) \tag{4.24}
$$

が得られる。

5重対角行列や7重対角行列についても、その行列式を求める手順をつくることは可能であろうが、加速度的に面倒になる。

### 4.2.6 DKA 法による固有値の計算

固有値を求めるには、与えられた行列を相似変換によって対角行列、三重対角行列、三角行列またはヘッセンベルグ行列に変換して、 $n$ 次代数方程式である特性方程式を解く。
$n$ 次代数方程式の解法は、第2章の非線形方程式の解法 (とくに代数方程式の解法) で学んだのでそれを応用すればよい。
DKA 法 (第 2 章参照) を応用すれば、固有値 $\lambda_j (j = 1, 2, \cdots , n)$ に対して、ア－バスの初期値

$$
\lambda_j^{(0)} = R_0 + R \exp \left[ \frac{2\pi}{n} i \left( j - \frac{3}{4} \right) \right] \qquad (j = 1, 2, \cdots, n) \tag{4.25}
$$

から出発して、

$$
\lambda_j^{(k+1)} = \lambda_j^{(k)} - \frac{\det(\lambda_j^{(k)} I - A^{\prime})}{\displaystyle\prod_{\substack{i = 1 \\ i \neq j}}^n (\lambda_j^{(k)} - \lambda_i^{(k)})} \qquad (j = 1, 2, \cdots , n) \tag{4.26}
$$

により、収束するまで $k = 1, 2, \cdots$ と反復する。
ここに、 $R_0$ は $\det(A^{\prime} - \lambda I)$ の $\lambda^n$ の係数 $a_0$ と $\lambda^{n-1}$ の係数 $a_1$ から求められる $n$ 個の固有値の複素平面上の重心で、

$$
R_0 = - \frac{a_1}{n a_0} = \frac{1}{n} \text{Tr}(A^{\prime}) = \frac{1}{n} \text{Tr}(A) \tag{4.27}
$$

$$
\left. \begin{aligned}
a_0 & = (-1)^n \\
a_1 & = (-1)^{n-1} \text{Tr}(A^{\prime}) = (-1)^{n-1} \text{Tr}(A) \\
\end{aligned} \right\} \tag{4.28}
$$

$\text{Tr}(A) \equiv a_{11} + a_{22} + \cdots + a_{nn}$ は行列 $A$ のトレ－ス (対角和) で、 $\text{Tr}(P^{-1} A P) = \text{Tr}(A)$ である (問題 4-4 参照)。
分子の $\det(A^{\prime} - \lambda I)$ は、前項の手順で計算すればよい。

まだ残っているのは $(4.25)$ の $R$ である。
$R$ は 中心が $R_0$ にあり、全ての解 $\lambda_j (1 \leqq j \leqq n)$ を含むような複素平面上の円の半径である。
第2章では多項式の係数 $a_0, a_1, \cdots , a_n$ を使って $R$ の推定を行ったが、 $\det(A^{\prime} - \lambda I)$ の $\lambda$ の各ベキ乗の係数 $a_0, a_1, \cdots , a_n$ を全部 $A^{\prime}$ の要素を使って求めるのは面倒である。
幸いにして固有値の存在する範囲を確定する定理がある。
この定理はゲルシュゴリン (Gerschgorin) の定理と呼ばれ、次の通りである。

***

$\text{ゲルシュゴリンの定理}$

固有値の存在する範囲を定めたい行列を $A = (\ a_{ij}\ )$ とする。
各行 $i = 1, 2, \cdots, n$ について、複素平面上に中心が対角要素 $a_{ii}$ であり、半径 $r_i$ が非対角要素の絶対値の和

$$
\begin{aligned}
r_i & = \vert a_{i1} \vert + \vert a_{i2} \vert + \cdots + \vert a_{i\ i-1} \vert + \vert a_{i\ i+1} \vert + \cdots + \vert a_{in} \vert \\
 & = \sum_{\substack{j = 1 \\ j \neq i}}^n \vert a_{ij} \vert \\
\end{aligned} \tag{4.29}
$$

であるような円を画く (図 4.4)。
行列 $A$ の固有値はこうして画いた $n$ 個の円のどれかの中にある。

***

$A^\top$ の固有値と $A$ の固有値は等しいことから、 $r_i$ とし ては各 $i$ 列の非対角要素の絶対値の和をとってもよい。
(ゲルシュゴリンの定理の証明は 問題 4-5 参照)

#### ［例 4.6］

第2章の連立1次方程式の反復法の解法における収束条件は、ヤコビ法の反復行列 $H = -D^{-1} (L + U)$ のスペクトル半径 $\rho$ が $\rho < 1$ であることであった。

$H$ の $i$ 行 $j$ 列の非対角要素は $h_{ij} = -a_{ij} / a_{ii}$ であり、対角要素は $h_{ii} = 0$ であるから、ゲルシュゴリンの定理の円は中心が原点にある同心円群である。
したがって、スペクトル半径は、半径 $r_i$ の最大のものと最小のものの間にあること、すなわち

$$
\min_i (r_i) = \min_i \left\{ \sum_{\substack{j = 1 \\ j \neq i}}^n \left\vert \frac{a_{ij}}{a_{ii}} \right\vert \right\} \leqq \rho \leqq \max_i (r_i) = \max_i \left\{ \sum_{\substack{j = 1 \\ j \neq i}}^n \left\vert \frac{a_{ij}}{a_{ii}} \right\vert \right\} \tag{4.30}
$$

になり、スペクトル半径の推定が出来る。

ゲルシュゴリンの定理を $A^{\prime} = P^{-1} A P = (\ a_{ij}^{\prime}\ )$ に適用する。
ゲルシュゴリンの円は $a_{ii}^{\prime}$ を中心とする半径 $r_i$ の円であるから (図 4.5 $12)$ )、 $R_0$ から最も遠い円周上の点までの距離は

$$
\vert a_{ii}^{\prime} - R_0 \vert + r_i = \vert a_{ii}^{\prime} - R0 \vert + \sum_{\substack{j = 1 \\ j \neq i}}^n \vert a_{ij}^{\prime} \vert
$$

である。
したがって、 $R$ は

$$
R = \max_i \left\{ \vert a_{ii}^{\prime} - R_0 \vert + \sum_{\substack{j = 1 \\ j \neq i}}^n \vert a_{ij}^{\prime} \vert \right\} \tag{4.31}
$$

である。
$R_0$ を中心とする半径 $R$ の円内にすべての固有値は存在するはずである。

こうして、固有値を求める手順は、次のようになる。

$(1)$ 任意の行列 $A$ を相似変換して $A^{\prime} = P^{-1} A P$ とする。

$(2)$ 求める固有値の初期値 $\lambda_j^{(0)} ( 1 \leqq j \leqq n )$ を $(4.25)$ とし、 $(4.26)$ により反復し収束させて求める。

# 第5章　数値積分

## 5.1 数値積分の公式

### 5.1.1 数値積分の公式

関数 $f(x)$ の定積分

$$
I = \int_a^b f(x) \ dx \tag{5.1}
$$

の値は、 $f(x)$ が簡単な場合を除いて、解析的に求めることは困難である。
定積分の近似値を数値的に求める公式を導くことが、この章の目的である。

数値積分の公式は、 $f(x)$ を容易に積分できる関数で近似し、 $(5.1)$ の $f(x)$ の代わりに積分し、

$$
I \cong I_n ≡ h \sum_{i=0}^n w_i f(x_i) \tag{5.2}
$$

の形に求める。
ここに、 $x_i$ は **分点** (point)、 $w_i$ は **重み** (weight) という。
$n + 1$ 個の分点は $x_0 < x_1 < x_2 < x_3 < \cdots < x_{n-1} < x_n$ のように、相異なるものとする。
また、容易に積分できる関数としては、 $x$ の多項式を選ぶのが普通である。

端点が積分の上限と下限に一致するとき、すなわち $x_0 = a$ 、 $x_n = b$ のとき、 $I_n$ は **閉型公式** という。
一致しないとき、すなわち $a < x_0$ 、 $x_n < b$ のとき、 **開型公式** という。

重み $w_i$ は $x_i$ にはよるが、 $f(x)$ にはよらない定数とする。
分点と重みは、誤差

$$
E_n = I - I_n \tag{5.3}
$$

が出来るだけ小さくなるように選ぶ。
誤差 $E_n$ は打切り誤差を以て表す。
$(5.2)$ は $n + 1$ 分点の公式である。
通常、 $n$ が大きいほど $E_n$ の小さな公式が導き出される。

なお、 **数値微分** については、問題 5-12 に簡単にふれておくに止める。

### 5.1.2 台形公式

最も簡単な数値積分の閉型公式は **台形公式** (trapezoidal formula) である。
まず、全閉区間 $[\ a,\ b\ ]$ を $N$ 等分し、分点を等間隔に置く。
すなわち

$$
x_i = a + ih \qquad (0 \leqq i \leqq N ) \qquad \text{ただし} \quad h = \frac{b - a}{N} \tag{5.4}
$$

もちろん、 $x_0 = a$ 、 $x_N = b$ である。
$f(x)$ の近似関数は1次式とする。
2つの分点 $x_i$ と $x_{i+1}$ で $f(x)$ と一致する1次式は

$$
p_1 (x) = \frac{x - x_{i+1}}{x_i - x_{i+1}} f(x_i) + \frac{x - x_i}{x_{i+1} - x_i} f(x_{i+1}) \tag{5.5}
$$

であることは容易に確かめられる。
$p_1(x)$ を一つの区間 $x_i$ から $x_{i+1}$ まで積分すると、一つの台形の面積が次のように得られる：

$$
\begin{aligned}
\int_{x_i}^{x_{i+1}} p_1(x) \ dx & = \int_0^h p_1(y + x_i) \ dy \cr
& = \int_0^h \left[ \frac{y - h}{-h} f(x_i) + \frac{y}{h} f(x_{i+1}) \right] \ dy \cr
& = \frac{h}{2} [f(x_i) + f(x_{i+1})]
\end{aligned}
$$

これより、

$$
\boxed{
\begin{aligned}
\quad \cr
& 台形公式 \cr
& \quad I_1 = \frac{h}{2} [ f(x_i) + f(x_{i+1} ) ] \cr
& \qquad \text{ただし} \quad h = x_{i+1} - x_i \cr
&& \quad \cr
\end{aligned} } \tag{5.6}
$$

台形公式 $(5.6)$ の場合、分点は $x_i$ と $x_{i+1}$ 、重み $w_i$ は

$$
w_0 = w_1 = \frac{1}{2} \tag{5.7}
$$

ととったことになる。

この面積を $x_0 = a$ から $x_N = b$ の $N$ 区間について加えると、

$$
I = \int_a^b f(x) \ dx = \sum_{i=0}^{N-1} \int_{x_i}^{x_{i+1}} f(x) \ dx
$$

であるから、 $(5.6)$ より、

$$
I \cong \frac{h}{2} \sum_{i=0}^{N-1} [\ f(x_i) + f(x_{i+1})\ ]
$$

隣合った各区間の上限と下限は一致するから、

$$
\boxed{
\begin{aligned}
\quad \cr
& \text{台形公式 (複合公式)} \cr
& \quad I_1 = h \left[ \frac{f(a) + f(b)}{2} + \sum_{i=1}^{N-1} f(x_i) \right] & \text{ただし} \quad h = \frac{b - a}{N} \quad
\end{aligned} } \tag{5.8}
$$

が得られる。
この公式が台形の面積の和であるという図上の意味は、図 5.1 より明かである。

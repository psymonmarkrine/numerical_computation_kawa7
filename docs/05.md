# 第5章　数値積分

## 5.1 数値積分の公式

### 5.1.1 数値積分の公式

関数 $f(x)$ の定積分

$$
I = \int_a^b f(x) \ dx \tag{5.1}
$$

の値は、 $f(x)$ が簡単な場合を除いて、解析的に求めることは困難である。
定積分の近似値を数値的に求める公式を導くことが、この章の目的である。

数値積分の公式は、 $f(x)$ を容易に積分できる関数で近似し、 $(5.1)$ の $f(x)$ の代わりに積分し、

$$
I \cong I_n ≡ h \sum_{i=0}^n w_i f(x_i) \tag{5.2}
$$

の形に求める。
ここに、 $x_i$ は **分点** (point)、 $w_i$ は **重み** (weight) という。
$n + 1$ 個の分点は $x_0 < x1 < x2 < x3 < \cdots < x_{n-1} < x_n$ のように、相異なるものとする。
また、容易に積分できる関数としては、 $x$ の多項式を選ぶのが普通である。

端点が積分の上限と下限に一致するとき、すなわち $x_0 = a$ 、 $x_n = b$ のとき、 $I_n$ は **閉型公式** という。
一致しないとき、すなわち $a < x0$ 、 $xn < b$ のとき、 **開型公式** という。

重み $w_i$ は $x_i$ にはよるが、 $f(x)$ にはよらない定数とする。
分点と重みは、誤差

$$
E_n = I - I_n \tag{5.3}
$$

が出来るだけ小さくなるように選ぶ。
誤差 $E_n$ は打切り誤差を以て表す。
$(5.2)$ は $n + 1$ 分点の公式である。
通常、 $n$ が大きいほど $E_n$ の小さな公式が導き出される。

なお、 **数値微分** については、問題 5-12 に簡単にふれておくに止める。

# 第3章 連立1次方程式

## 3.1 直接法と反復法

### 3.1.1 直接法・反復法

実数の係数をもつ $n$ 元連立1次方程式

$$
\begin{array}{ll}
    a_{11} x_1 + a_{12} x_2 + a_{13} x_3 + \cdots + a_{1n} x_n & = b_1 \quad (1) \\
    a_{21} x_1 + a_{22} x_2 + a_{23} x_3 + \cdots + a_{2n} x_n & = b_2 \quad (2) \\
    a_{31} x_1 + a_{32} x_2 + a_{33} x_3 + \cdots + a_{3n} x_n & = b_3 \quad (3) \\
    \cdots \, \cdots \\
    a_{i1} x_1 + a_{i2} x_2 + a_{i3} x_3 + \cdots + a_{in} x_n & = b_i \quad (\,i\,) \\
    \cdots \, \cdots \\
    a_{n1} x_1 + a_{n2} x_2 + a_{n3} x_3 + \cdots + a_{nn} x_n & = b_n \quad (n) \\
\end{array} \tag{3.1}
$$

の数値解法は、大きく分けて直接法と反復法の2つがある。
直接法は、手順を1回実行すれば解が求められる。
反復法は、必要な精度の近似値が得られるまで、手順を反復する。
直接法は、解を求めるまでの演算回数は少なくてよいが、とくに大型行列の連立1次方程式の場合、高い精度の近似解が得にくい。
それは、直接法では解を求める途中で係数を書き換えてしまうが、書き換えの過程で誤差が発生することによる。
反復法では最後まで係数はもとのままである。
したがって、小さな連立1次方程式は直接法によることが多く、大型の連立1次方程式は反復法によることが多い。

本章で取り上げる連立1次方程式の数値解法は、次の通りである。

$$
\begin{array}{clll}
1 & \text{ガウスの消去法} & \text{直接法} \\
2 & \text{LU分解法} & \text{直接法} \\
3 & \text{コレスキー分解法} & \text{直接法} & \text{対称行列} \\
4 & \text{ヤコビ法} & \text{反復法} \\
5 & \text{ガウス・ザイデル法} & \text{反復法} \\
6 & \text{SOR法} & \text{反復法} \\
7 & \text{共役勾配法} & \text{ベクトル反復法} & \text{対称行列 (非対称行列)} \\
\end{array}
$$

ガウスの消去法はもっとも基本的な直接法である。
LU 分解法は、ガウスの消去法をやや一般化して使いやすくしたものである。
コレスキー分解法は、LU 分解法を対称行列用に改造して半分の演算量で解を求めることのできる方法である。


ヤコビ法はもっとも基本的な反復法である。
ガウス・ザイデル法はヤコビ法を簡単にした結果、収束が早くなり、かつ記憶容量も少なくなっている。
SOR 法はガウス・ザイデル法の収束を加速した方法である。

共役勾配法は、対称な大型行列用の方法であり、近年にわかに使用されるようになっている。
とくに収束を加速した共役勾配法 (ICCG 法など) は、大型対称行列に対する主流となっている。
そのほか、本章の問題中には、非対称行列用の共役残差法 (CR 法)、双共役勾配法 (BCG 法) および自乗共役勾配法 (CGS 法) についてふれる。
これらの方法はベクトル反復法と呼ばれている。

以上のように、ここで説明する7つの方法は、直接法と反復法の2つの系統に分類される。
解くべき連立1次方程式の性質によって、これらの方法を使いわける必要がある。

## 3.2 ガウスの消去法

### 3.2.1 ガウスの消去法

連立1次方程式 $(3.1)$ の数値解法の中でもっとも基本的な解法は、ここで述べるガウスの消去法である。
筆算による連立1次方程式の解法でもっともよく用いられる解法は、消去法によって未知数を消去し、最後に残った未知数を求め、以下代入法によって順次残りの未知数を求める方法であろう。
ガウスの消去法は、筆算における消去法と代入法を順序立てて手順にまとめあげたものでもある。

### 3.2.2 前進消去

$n$元連立1次方程式 $(3.1)$ において、まず未知数 $x_1$ を消去する。
それには、第1式 $(1)$ を $x_1$ の係数 $a_{11}$ で割って、

$$
x_1 + a_{12}^{(1)} x_2 + a_{13}^{(1)} x_3 + \cdots + a_{1n}^{(1)} x_n = b_{1}^{(1)} \quad (1^{\prime})
$$

とし 、次いで第2式 $(2)$ から $(1^{\prime})$ の $a_{21}$ 倍を引くと $x_1$ が消去される：

$$
a_{22}^{(1)} x_2 + a_{23}^{(1)} x_3 + \cdots + a_{2n}^{(1)} x_n = b_{2}^{(1)} \qquad (2^{\prime})
$$

一般に第 i 式 $(i)$ から $(1^{\prime})$ の $a_{i1}$ 倍を引くと、 $x_1$ が消去され

$$
a_{i2}^{(1)} x_2 + a_{i3}^{(1)} x_3 + \cdots + a_{in}^{(1)} x_n = b_{i }^{(1)} \qquad (i^{\prime})
$$

が得られる。
$i = 2, 3, \cdots, n$ の順に繰り返すと、第2式, $\cdots$ 第 $n$ 式から $x_1$ が消去される。
このとき、新しい係数 $a_{ij}^{(1)}$ 、 $b_i^{(1)}$ は、

$$
\begin{array}{lll}
\text{第1行} & a_{11}^{(1)} = 1 \\
           & a_{1j}^{(1)} = a_{1j} / a_{11} & j > 1 \\
           & b_1^{(1)} = b_1 / a_{11} \\

\text{第2行以下} & a_{i1}^{(1)} = 0 & i > 1 \\
           & a_{ij}^{(1)} = a_{ij} - a_{i1} a_{1j}^{(1)} & i > 1, \quad j > 1 \\
           & b_i^{(1)} = b_i - a_{i1} b_1^{(1)} & i > 1 \\
\end{array}
$$

である。
こうして、第2式以降から $x_1$ が消去された。

次ぎに、第3式以降から $x_2$ を消去するには、第2式 $(2^{\prime})$ を $a_{22}^{(1)}$ で割って、

$$
x_2 + a_{23}^{(2)} x_3 + \cdots + a_{2n}^{(2)} x_n = b_2^{(2)} \qquad (2^{\prime\prime})
$$

とし、第 $i$ 式 $(i^{\prime})$ (ただし $i > 2$ ) 以降から $(2^{\prime\prime})$ の $a_{i2}^{(1)}$ 倍を引けばよい：

$$
a_{i3}^{(2)} x_3 + a_{i4}^{(2)} x_4 + \cdots + a_{in}^{(2)} x_n = b_{i}^{(2)} \qquad (i^{\prime\prime})
$$

ただし 、

$$
\begin{array}{lll}
\text{第2行} & a_{22}^{(2)} = 1 \\
 & a_{2j}^{(2)} = a_{2j}^{(1)} /a_{22}^{(1)} & j > 2 \\
 & b_{2}^{(2)} = b_{2}^{(1)} / a_{22}^{(1)} \\
\text{第3行以下} & a_{i2}^{(2)} = 0 & i > 2 \\
 & a_{ij}^{(2)} = a_{ij}^{(1)} - a_{i2}^{(1)} a_{2j}^{(2)} & i > 2,  \quad j > 2 \\
 & b_{i}^{(2)} = b_{i}^{(1)}- a_{i2}^{(1)} b_{2}^{(2)} & i > 2 \\
\end{array}
$$

いま第 $k$ 式以降の式の $x_1$ からまで $x_{k-1}$ までがすでに消去されているとき、第 $k + 1$ 式以降から $x_k$ を消去することを考える。
それには、第 $k$ 式を $a_{kk}^{(k-1)}$ で割り、第 $k + 1$ 式以降の第 $i$ 式 $(i > k)$ から、第 $k$ 式 $(a_{kk}^{(k)} = 1)$ の $a_{kj}^{(k-1)}$ 倍を引けばよい。
すなわち、 $k = 1, 2, \cdots, n$ の順に

$$
\begin{array}{ll}
\text{ガウスの消去法の前進消去} \\
\quad a_{kk}^{(k)} = 1 \\
\quad a_{kj}^{(k)} = a_{kj}^{(k-1)} / a_{kk}^{(k-1)} & j > k \\
\quad b_{k}^{(k)} = b_{k}^{(k-1)} / a_{kk}^{(k-1)} \\
\quad a_{ik}^{(k)} = 0 & i > k \\
\quad a_{ij}^{(k)} = a_{ij}^{(k-1)} - a_{ik}^{(k-1)} a_{kj}^{(k)} & i > k, j > k \\
\quad b_{i}^{(k)} = b_{i}^{(k-1)} - a_{ik}^{(k-1)} b_{k}^{(k)} & i > k \\
\end{array} \tag{3.2}
$$

と係数と定数項を変化させると、対角要素はすべて $1$ になり、対角要素の下の要素はすべて $0$ になり、係数行列は上三角行列になる。
<details><summary></summary><div>

$(3.2)$ を PAD で表したものが、図 3.1 の 前進消去の部分である。
この PAD では、 $a_{ij}^{(k)}$ はすべての $k$ に対して同じ配列要素 `a(i,j)` に次々と上書きしている。
それは、 $a_{ij}^{(k)}$ が求められた後では $a_{ij}^{(k-1)}$ 以前の配列要素 `a(i,j)` の値を再び参照することはないからである。
また、 PAD では、対角要素 $1$ と下三角行列の $0$ はわかりきっているので、 $1$ にしたり $0$ にしたりする演算は行なっていない<sup>[$1)$](#note1)</sup> 。

> <small id="note1">$^{1)}$ $e_{n-1}(z)$ は $n - 1$ 次のラグランジュ補間多項式による $z^s$ の近似の誤差である。 $(5.53)$ 、 $(5.57)$ 参照。</small>
</div></details>

$(3.2)$ の手順が完了したときには、連立1次方程式は、次の形に変形されている。

$$
\begin{aligned}
x_1 + a_{12}^{(1)} x_2 + a_{13}^{(1)} x_3 + \cdots + a_{1n-1}^{(1)} x_{n-1} + a_{1n}^{(1)} x_n & = b_1^{(1)} \\
x_2 + a_{23}^{(2)} x_3 + \cdots + a_{2n-1}^{(2)} x_{n-1} + a_{2n}^{(2)} x_n & = b_2^{(2)} \\
x_3 + \cdots + a_{3n-1}^{(3)} x_{n-1} + a_{3n}^{(3)} x_n & = b_3^{(3)} \\
\cdots \, \cdots \\
x_{n-1} + a_{n-1n}^{(n-1)} x_n & = b_{n-1}^{(n-1)} \\
x_n & = b_n^{(n)}
\end{aligned} \tag{3.2’}
$$

<details><summary></summary><div>

なお、 PAD では同じ 係数 $A$ を持つ $m$ 個の問題を一挙に解くことができるようにしてある。
そのために、定数項は係数の行列の $第 n + 1 列, n + 2 列, \cdots n + m
列$ に記憶させてある。
すなわち、第 $i$ 行は

$$
\begin{array}{}
a_{i\ n+1} = b_{i\ 1}, & a_{i\ n+2} = b_{i\ 2}, & \cdots & a_{i\ n+m} = b_{i\ m}
\end{array}
$$

である。
こうしておくと PAD 、したがって手順が簡単になる。
ピボット選択については後で述べる。
</div></details>

### 3.2.3 後退代入

前進消去の結果 $x_n$ は解けている。
$x_{n-1}$ は最後から2番目の式を用いて、

$$
x_{n-1} = b_{n-1}^{(n-1)} - a_{n-1n}^{(n-1)} x_n
$$

以下同じようにして $k = n - 1, n - 2, \cdots , 2, 1$ と逆順に代入を繰り返して行けば、 $x_k$ が

$$
\begin{array}{r}
\text{ガウスの消去法の後退代入} \\
x_k = b_k^{(k)} - \sum\limits_{j=k+1}^n a_{kj}^{(k)} x_j
\end{array} \tag{3.3}
$$

と求められる。
これを後退代入という。

<details><summary></summary><div>

図 3.1 の PAD における後退代入が $(3.3)$ の手順である。
ここでも、 $m$ 組の定数項は `a(i,j)` の $j = n + 1, n + 2, \cdots , n + m$ 列にあり、かつ、それぞれの定数項のところに解 $x_j$ が求められる。
</div></details>

### 3.2.4 ピボット 選択

$(3.2)$ では、対角要素 $a_{kk}^{(k-1)}$ で割算をしている。
もし対角要素が $0$ であればこの割算はできないし、 $0$ でなくても非常に (絶対値の) 小さな数であれば、 $a_{kj}^{(k)}$ および $b_k{(k)}$ が異常に大きくなり、その結果 $a_{ij}^{(k)}$ および $b_i^{(k)}$ の右辺の第1項と第2項の大きさが極端に違ってきて、小さい第1項は大きい第2項によって丸めの誤差として無視されてしまう。
この丸めの誤差を小さく抑えるためには、割算をする要素の値が大きいことが必要である。
この要素のことを、ピボット (pivot － 枢軸、<ruby>要<rp>(</rp><rt>かなめ</rt><rp>)</rp></ruby> ) という。
$(3.2)$ ではピボットとしては対角要素を選んだが、できるだけ大きい要素を選ぶことが必要である。
ピボットとしてできるだけ大きい要素を選ぶことをピボット選択 (pivotting) という。

すでに消去が終わっている未知数の係数をピボットとして選ぶことはできない。
ピボット選択の範囲は $x_{k-1}$ まで消去できているときは、 $a_{ij}^{(k-1)}$ のうち $i \geqq k,\ j \geqq k$ の範囲の中から選択することになる。
この $(n - k + 1)^2$ 個の要素の全範囲から選択することを完全ピボット選択 (complete pivotting) という。
これに対して第 $k$ 列の中、すなわち、 $i \geqq k,\ j = k$ の中から選択することを部分ピボット選択 (partial pivotting) という。

ピボットとして $a_{ij}^{(k-1)}$ を選択したとき、それが第 $k$ 列にあるとき $(j = k)$ 、第 $i$ 番目の方程式と第 $k$ 番目の方程式と入れ換えてやることが必要である。
方程式の順番の入れ換えによっては解は変わらないから、入れ換えた後の手順の変更はいらない。
一方 $j \neq k$ の時は、未知数 $x_k$ と $x_j$ との入れ換えが必要になる。
したがって、完全ピボット選択を行ったときは、解を求めた後、未知数の順番をもとに戻してやらねばならない。

完全ピボット選択の方が、解の精度がよいことは当然であるが、選択の範囲が広いために手数がかかり、また未知数の順番を戻す必要があるため、小さな連立1次方程式は部分ピボット選択で済ませる。
大きな連立1次方程式の場合は直接法は用いず、反復法を用いることにする。

## 3.3 $\text{LU}$ 分解法

### 3.3.1 $\text{LU}$ 分解法

$n$ 次連立1次方程式 $(3.1)$ は

$$
Ax = b \tag{3.4}
$$

と書ける。
ただし $A$ は $n$ 次正方行列で、

$$
A = \begin{pmatrix}
    a_{11} & a_{12} & a_{13} & \cdots & a_{1n} \\
    a_{21} & a_{22} & a_{23} & \cdots & a_{2n} \\
    a_{31} & a_{32} & a_{33} & \cdots & a_{2n} \\
    \vdots & \vdots & \vdots & \ddots & \vdots \\
    a_{n1} & a_{n2} & a_{n3} & \cdots & a_{nn} \\
\end{pmatrix}
$$

いま、 $A$ を

$$
A = LU \tag{3.5}
$$

と分解したとしよう。
ここに $L$ は下三角行列、 $U$ は対角要素が $1$ である上三角行列である：

$$
L = \begin{pmatrix}
    l_{11} \\
    l_{21} & l_{22} & & \large{0} \\
    l_{31} & l_{32} & l_{33} \\
    \vdots & \vdots & \vdots & \ddots \\
    l_{n1} & l_{n2} & l_{n3} & \cdots & l_{nn} \\
\end{pmatrix}, \quad
U = \begin{pmatrix}
    1 & u_{12} & u_{13} & \cdots & u_{1n} \\
    & 1 & u_{23} & \cdots & u_{2n} \\
    & & 1 & \cdots & u_{3n} \\
    & \large{0} & & \ddots & \vdots \\
    & & & & 1 \\
\end{pmatrix}
$$

この分解を $\text{LU}$ 分解という<sup>[$2)$](#note2)</sup> 。

> <small id="note1">$^{2)}$ このように $U$ の対角要素を $1$ とする方法をドウリトル (Doolittle) 法、 $L$ の対角要素を $1$ とする方法をクラウト (Crout) 法と呼ぶ。
> このどちらの方法も $\text{LU}$ 分解は一意的である。
> ガウスの消去法との関連が明らかなため、ここではドウリトル法について述べる。</small>



行列 $A$ を $\text{LU}$ 分解できたら、この2つの行列 $L$ と $U$ とを用いて、 $(3.4)$ と $(3.5)$から $x$ を簡単な手順によって求めることが出来る。
すなわち、 $y = U x$ と置くと、 $(3.4)$ は2つの連立1次方程式

$$
L y = b \tag{3.6}
$$

$$
U x = y \tag{3.7}
$$

に分けられる。
$(3.6)$ より $y$ を求め、この $y$ を $(3.7)$ に代入して $x$ を求めれば、 $(3.4)$ の解 $x$ が求められる。

$(3.6)$ と $(3.7)$ を解くことは、 $L$ と $U$ が三角行列であるために容易である。
実際 $(3.6)$ を要素ごとに第1式から第 $n$ 式の順に書くと

$$
\begin{array}{lll}
l_{11} y_1 = b_1 & \therefore & y_1 = b_1 / l_{11} \\
l_{21} y_1 + l_{22} y_2 = b_2 & \therefore & y_2 = (b_2 - l_{21} y_1) / l_{22} \\
\qquad \cdots & & \qquad \cdots \\
\sum\limits_{j=1}^{n-1} l_{nj} y_j + l_{nn} y_n = b_n & \therefore & y_n = \left(
b_n - \sum\limits_{j=1}^{n-1} l_{nj} y_j \right) / l_{nn} \\
\end{array}
$$

と $y_1, y_2, \cdots , y_n$ の順に次々と求めることが出来る。
これを、前進代入という。

次に、 $(3.7)$ を第 $n$ 式から第1式の順に書いて、 $x_n$ から $x_1$ を逆順に求めることが出来る。
すなわち

$$
\begin{array}{lll}
x_n = y_n  & \therefore & x_n = y_n \\
x_{n-1} + u_{n-1n} x_n = y_{n-1}  & \therefore & x_{n-1} = y_{n-1} - u_{n-1n} x_n \\
\qquad \cdots & & \qquad \cdots \\
x_1 + \sum\limits_{j=2}^n u_{1j} x_j = y_n  & \therefore & x_1 = y_n - \sum\limits_{j=2}^n u_{1j} x_j \\
\end{array}
$$

である。
これを、後退代入という。

$A$ を $\text{LU}$ 分解し、前進代入と後退代入によって解 $x$ を求める解法を $\text{LU}$ 分解法という。

### 3.3.2 $\text{LU}$ 分解

$\text{LU}$ 分解の手順は、前節のガウスの消去法の前進消去の手順と同じであることを示す。
そのために、ガウスの消去法の前進消去の手順 $(3.2)$ を行列 $G$ で表すと、

$$
GA = U =
\begin{pmatrix}
 1 & a_{12}^{(1)} & a_{13}^{(1)} & \cdots & a_{1n}^{(1)} \\
 & 1 & a_{23}^{(2)} & \cdots & a_{2n}^{(2)} \\
 & & 1 & \cdots & a_{3n}^{(3)} \\
 & \large{0} & & \ddots & \vdots \\
 & & & & 1
\end{pmatrix}
$$

であり、 $U$ は対角要素が $1$ である上三角行列であることに注意する ($(3.2’)$ を参照）。
この式から $A = G^{-1} U$ であるから、 $L = G^{-1}$ と置くと、 $\text{LU}$ 分解 $A = LU$
が得られる。

まず、 $G = G_n G_{n-1} \cdots G_k \cdots G_2 G_1$ と置き、 $k$ 回目の前進消去 $(3.2)$ を

$$
a_{ij}^{(k)} =
\left\{
\begin{array}{lll}
    a_{kj}^{(k-1)} / a_{kk}^{(k-1)} & i = k, & j \geqq k \\
    a_{ij}^{(k-1)} - a_{ik}^{(k-1)} a_{kj}^{(k)} & i > k, & j \geqq k \\
\end{array}
\right.
$$

と書き、これを $G_k$ で表すと、

$$
G_k =
\begin{pmatrix}
    1 \\
    & \ddots & & & & \large{0} \\
    & & 1 \\
    & & & 1 \\
    & & & -a_{k+1k}^{(k-1)} & 1 \\
    & \large{0} & & \vdots & & \ddots \\
    & & & -a_{nk}^{(k-1)} & & & 1 \\
\end{pmatrix}
\begin{pmatrix}
    1 \\
    & \ddots & & & & \large{0} \\
    & & 1 \\
    & & & 1/a_{kk}^{(k-1)} \\
    & & & & 1 \\
    & \large{0} & & & & \ddots \\
    & & & & & & 1 \\
\end{pmatrix}
$$

である。したがって、 $G_k^{-1} は<sup>[$3)$](#note3)</sup>

$$
\begin{aligned}
G_k^{-1} & =
\begin{pmatrix}
    1 \\
    & \ddots & & & & \large{0} \\
    & & 1 \\
    & & & a_{kk}^{(k-1)} \\
    & & & & 1 \\
    & \large{0} & & & & \ddots \\
    & & & & & & 1 \\
\end{pmatrix}
\begin{pmatrix}
    1 \\
    & \ddots & & & & \large{0} \\
    & & 1 \\
    & & & 1 \\
    & & & a_{k+1k}^{(k-1)} & 1 \\
    & \large{0} & & \vdots & & \ddots \\
    & & & a_{nk}^{(k-1)} & & & 1 \\
\end{pmatrix} \\
& =
\begin{pmatrix}
    1 \\
    & \ddots & & & & \large{0} \\
    & & 1 \\
    & & & a_{kk}^{(k-1)} \\
    & & & a_{k+1k}^{(k-1)} & 1 \\
    & \large{0} & & \vdots & & \ddots \\
    & & & a_{nk}^{(k-1)} & & & 1 \\
\end{pmatrix}
\end{aligned}
$$

である。

<small id="note3">$^{3)}$ $A, B$ を $n$ 次正方行列とすると、 $(AB)^{−1} = B^{−1} A^{−1}$。</small>

$L = G^{-1} = G_1^{-1} G_2^{-1} \cdots G_k^{-1} \cdots G_{n-1}^{-1} G_n^{-1}$ は $G_k^{-1} (k = 1, \cdots n)$ の積であるから、

$$
\begin{aligned}
G_n^{-1} & =
\begin{pmatrix}
    1 \\
    & \ddots & & & \large{0} \\
    & & 1 \\
    & & & 1 \\
    & \large{0} & & & 1 \\
    & & & & & a_{nn}^{(n-1)} \\
\end{pmatrix}
\\ \\
G_{n-1}^{-1} G_n^{-1} & =
\begin{pmatrix}
    1 \\
    & \ddots & & & \large{0} \\
    & & 1 \\
    & & & 1 \\
    & \large{0} & & & a_{n-1n-1}^{(n-2)} \\
    & & & & a_{nn-1}^{(n-2)} & 1 \\
\end{pmatrix} G_n^{-1} \\
& =
\begin{pmatrix}
    1 \\
    & \ddots & & & \large{0} \\
    & & 1 \\
    & & & 1 \\
    & \large{0} & & & a_{n-1n-1}^{(n-2)} \\
    & & & & a_{nn-1}^{(n-2)} & a_{nn}^{(n-1)} \\
\end{pmatrix}
\\ \\
G_{n-2}^{-1} ( G_{n-1}^{-1} G_{n}^{-1} ) & =
\begin{pmatrix}
    1 \\
    & \ddots & & & \large{0} \\
    & & 1 \\
    & & & a_{n-2n-2}^{(n-3)} \\
    & \large{0} & &a_{n-1n-2}^{(n-3)} & 1 \\
    & & & a_{nn-2}^{(n-3)} & & 1 \\
\end{pmatrix}
\begin{pmatrix}
    1 \\
    & \ddots & & & \large{0} \\
    & & 1 \\
    & & & 1 \\
    & \large{0} & & & a_{n-1n-1}^{(n-2)} \\
    & & & & a_{nn-1}^{(n-2)} & a_{nn}^{(n-1)} \\
\end{pmatrix} \\
& = 
\begin{pmatrix}
    1 \\
    & \ddots & & & \large{0} \\
    & & 1 \\
    & & & a_{n-2n-2}^{(n-3)} \\
    & \large{0} & &a_{n-1n-2}^{(n-3)} & a_{n-1n-1}^{(n-2)} \\
    & & & a_{nn-2}^{(n-3)} & a_{nn-1}^{(n-2)} & a_{nn}^{(n-1)} \\
\end{pmatrix} \\ \\
& \qquad \cdots \, \cdots \, \cdots \, \cdots
\end{aligned}
$$

と繰り返していけば

$$
\begin{aligned}
L & = G^{-1} = G_1^{-1} ( G_2^{-1} \cdots G_k^{-1} \cdots G_{n-1}^{-1} G_n^{-1} ) \\
& =
\begin{pmatrix}
    a_{11} \\
    a_{21} & 1 & & & \large{0} \\
    a_{31} & & 1 \\
    \vdots & & & \ddots \\
    \vdots & & & & \ddots \\
    a_{n1} & & & & & 1 \\
\end{pmatrix}
\begin{pmatrix}
    1 \\
    & a_{22}^{(1)} & & & \large{0} \\
    & a_{32}^{(1)} & a_{33}^{(2)} \\
    & \vdots & & \ddots \\
    & \vdots & & & \ddots \\
    & a_{n2}^{(1)} & a_{n3}^{(2)} & \cdots & \cdots & a_{nn}^{(n-1)} \\
\end{pmatrix} \\
& =
\begin{pmatrix}
    a_{11} \\
    a_{21} &　a_{22}^{(1)} & & & \large{0} \\
    a_{31} &　a_{32}^{(1)} & a_{33}^{(2)} \\
    \vdots &　\vdots & & \ddots \\
    a_{n1} &　a_{n2}^{(1)} & a_{n3}^{(2)} & \cdots & a_{nn}^{(n-1)} \\
\end{pmatrix}
\end{aligned}
$$

が得られる。
$L = G^{-1} (l_{ij} = a_{ij}^{(j-1)} )$ は求める下三角行列である。

$L$ の各要素は、 $(3.2)$ において $a_{kk}^{(k)} = 1, a_{ik}^{(k)} = 0 (i > k)$ とする直前の値である。
<details><summary></summary><div>

図 3.1 のガウスの消去法の PAD の［前進消去］の手順では $1$ あるいは $0$ にする演算はしていないから、この値は保存されている。
すなわち、ガウスの消去法の PAD 図 3.1 の ［前進消去］ の手順が完了したときには、行列 $A$ は次のようになっている：

$$
\begin{pmatrix}
    a_{11} & a_{12}^{(1)} & a_{13}^{(1)} & \cdots & a_{1n}^{(1)} \\
    a_{21} & a_{22}^{(1)} & a_{23}^{(2)} & \cdots & a_{2n}^{(2)} \\
    a_{31} & a_{32}^{(1)} & a_{33}^{(2)} & \cdots & a_{3n}^{(3)} \\
    \vdots & \vdots & \vdots & \ddots & \vdots \\
    a_{n1} & a_{n2}^{(1)} &  a_{n3}^{(2)} & \cdots & a_{nn}^{(n-1)} \\
\end{pmatrix}
=
\begin{pmatrix}
l_{11} & u_{12} & u_{13} & \cdots & u_{1n} \\
l_{21} & l_{22} & u_{23} & \cdots & u_{2n} \\
l_{31} & l_{32} & l_{33} & \cdots & u_{3n} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
l_{n1} & l_{n2} & l_{n3} & \cdots & l_{nn} \\
\end{pmatrix}
$$

ガウスの消去法においては、このうち $u_{ij}$ を用いて後退代入を行って解 $x$ を求めた。
一方、 $\text{LU}$ 分解法においては、 $l_{ij}$ を用いて前進代入を行い、 $u_{ij}$ を用いて後退代入を行って解 $x$ を求めるのである。

以上の $\text{LU}$ 分解の手順を PAD 図 3.2 の［ $\text{LU}$ 分解］に示す。
この手順は、ガウスの消去法の［前進消去］の手順と同じである。
したがって、係数行列 $A$ は上のように変換されている。
</div></details>

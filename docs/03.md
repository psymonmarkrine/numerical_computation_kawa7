# 第3章 連立1次方程式

## 3.1 直接法と反復法

### 3.1.1 直接法・反復法

実数の係数をもつ $n$ 元連立1次方程式

$$
\begin{array}{ll}
    a_{11} x_1 + a_{12} x_2 + a_{13} x_3 + \cdots + a_{1n} x_n & = b_1 \quad (1) \\
    a_{21} x_1 + a_{22} x_2 + a_{23} x_3 + \cdots + a_{2n} x_n & = b_2 \quad (2) \\
    a_{31} x_1 + a_{32} x_2 + a_{33} x_3 + \cdots + a_{3n} x_n & = b_3 \quad (3) \\
    \cdots \, \cdots \\
    a_{i1} x_1 + a_{i2} x_2 + a_{i3} x_3 + \cdots + a_{in} x_n & = b_i \quad (\,i\,) \\
    \cdots \, \cdots \\
    a_{n1} x_1 + a_{n2} x_2 + a_{n3} x_3 + \cdots + a_{nn} x_n & = b_n \quad (n) \\
\end{array} \tag{3.1}
$$

の数値解法は、大きく分けて直接法と反復法の2つがある。
直接法は、手順を1回実行すれば解が求められる。
反復法は、必要な精度の近似値が得られるまで、手順を反復する。
直接法は、解を求めるまでの演算回数は少なくてよいが、とくに大型行列の連立1次方程式の場合、高い精度の近似解が得にくい。
それは、直接法では解を求める途中で係数を書き換えてしまうが、書き換えの過程で誤差が発生することによる。
反復法では最後まで係数はもとのままである。
したがって、小さな連立1次方程式は直接法によることが多く、大型の連立1次方程式は反復法によることが多い。

本章で取り上げる連立1次方程式の数値解法は、次の通りである。

$$
\begin{array}{clll}
1 & \text{ガウスの消去法} & \text{直接法} \\
2 & \text{LU分解法} & \text{直接法} \\
3 & \text{コレスキー分解法} & \text{直接法} & \text{対称行列} \\
4 & \text{ヤコビ法} & \text{反復法} \\
5 & \text{ガウス・ザイデル法} & \text{反復法} \\
6 & \text{SOR法} & \text{反復法} \\
7 & \text{共役勾配法} & \text{ベクトル反復法} & \text{対称行列 (非対称行列)} \\
\end{array}
$$

ガウスの消去法はもっとも基本的な直接法である。
LU 分解法は、ガウスの消去法をやや一般化して使いやすくしたものである。
コレスキー分解法は、LU 分解法を対称行列用に改造して半分の演算量で解を求めることのできる方法である。


ヤコビ法はもっとも基本的な反復法である。
ガウス・ザイデル法はヤコビ法を簡単にした結果、収束が早くなり、かつ記憶容量も少なくなっている。
SOR 法はガウス・ザイデル法の収束を加速した方法である。

共役勾配法は、対称な大型行列用の方法であり、近年にわかに使用されるようになっている。
とくに収束を加速した共役勾配法 (ICCG 法など) は、大型対称行列に対する主流となっている。
そのほか、本章の問題中には、非対称行列用の共役残差法 (CR 法)、双共役勾配法 (BCG 法) および自乗共役勾配法 (CGS 法) についてふれる。
これらの方法はベクトル反復法と呼ばれている。

以上のように、ここで説明する7つの方法は、直接法と反復法の2つの系統に分類される。
解くべき連立1次方程式の性質によって、これらの方法を使いわける必要がある。

## 3.2 ガウスの消去法

### 3.2.1 ガウスの消去法

連立1次方程式 $(3.1)$ の数値解法の中でもっとも基本的な解法は、ここで述べるガウスの消去法である。
筆算による連立1次方程式の解法でもっともよく用いられる解法は、消去法によって未知数を消去し、最後に残った未知数を求め、以下代入法によって順次残りの未知数を求める方法であろう。
ガウスの消去法は、筆算における消去法と代入法を順序立てて手順にまとめあげたものでもある。

### 3.2.2 前進消去

$n$元連立1次方程式 $(3.1)$ において、まず未知数 $x_1$ を消去する。
それには、第1式 $(1)$ を $x_1$ の係数 $a_{11}$ で割って、

$$
x_1 + a_{12}^{(1)} x_2 + a_{13}^{(1)} x_3 + \cdots + a_{1n}^{(1)} x_n = b_{1}^{(1)} \quad (1^{\prime})
$$

とし 、次いで第2式 $(2)$ から $(1^{\prime})$ の $a_{21}$ 倍を引くと $x_1$ が消去される：

$$
a_{22}^{(1)} x_2 + a_{23}^{(1)} x_3 + \cdots + a_{2n}^{(1)} x_n = b_{2}^{(1)} \qquad (2^{\prime})
$$

一般に第 i 式 $(i)$ から $(1^{\prime})$ の $a_{i1}$ 倍を引くと、 $x_1$ が消去され

$$
a_{i2}^{(1)} x_2 + a_{i3}^{(1)} x_3 + \cdots + a_{in}^{(1)} x_n = b_{i }^{(1)} \qquad (i^{\prime})
$$

が得られる。
$i = 2, 3, \cdots, n$ の順に繰り返すと、第2式, $\cdots$ 第 $n$ 式から $x_1$ が消去される。
このとき、新しい係数 $a_{ij}^{(1)}$ 、 $b_i^{(1)}$ は、

$$
\begin{array}{lll}
\text{第1行} & a_{11}^{(1)} = 1 \\
           & a_{1j}^{(1)} = a_{1j} / a_{11} & j > 1 \\
           & b_1^{(1)} = b_1 / a_{11} \\

\text{第2行以下} & a_{i1}^{(1)} = 0 & i > 1 \\
           & a_{ij}^{(1)} = a_{ij} - a_{i1} a_{1j}^{(1)} & i > 1, \quad j > 1 \\
           & b_i^{(1)} = b_i - a_{i1} b_1^{(1)} & i > 1 \\
\end{array}
$$

である。
こうして、第2式以降から $x_1$ が消去された。

次ぎに、第3式以降から $x_2$ を消去するには、第2式 $(2^{\prime})$ を $a_{22}^{(1)}$ で割って、

$$
x_2 + a_{23}^{(2)} x_3 + \cdots + a_{2n}^{(2)} x_n = b_2^{(2)} \qquad (2^{\prime\prime})
$$

とし、第 $i$ 式 $(i^{\prime})$ (ただし $i > 2$ ) 以降から $(2^{\prime\prime})$ の $a_{i2}^{(1)}$ 倍を引けばよい：

$$
a_{i3}^{(2)} x_3 + a_{i4}^{(2)} x_4 + \cdots + a_{in}^{(2)} x_n = b_{i}^{(2)} \qquad (i^{\prime\prime})
$$

ただし 、

$$
\begin{array}{lll}
\text{第2行} & a_{22}^{(2)} = 1 \\
 & a_{2j}^{(2)} = a_{2j}^{(1)} /a_{22}^{(1)} & j > 2 \\
 & b_{2}^{(2)} = b_{2}^{(1)} / a_{22}^{(1)} \\
\text{第3行以下} & a_{i2}^{(2)} = 0 & i > 2 \\
 & a_{ij}^{(2)} = a_{ij}^{(1)} - a_{i2}^{(1)} a_{2j}^{(2)} & i > 2,  \quad j > 2 \\
 & b_{i}^{(2)} = b_{i}^{(1)}- a_{i2}^{(1)} b_{2}^{(2)} & i > 2 \\
\end{array}
$$

いま第 $k$ 式以降の式の $x_1$ からまで $x_{k-1}$ までがすでに消去されているとき、第 $k + 1$ 式以降から $x_k$ を消去することを考える。
それには、第 $k$ 式を $a_{kk}^{(k-1)}$ で割り、第 $k + 1$ 式以降の第 $i$ 式 $(i > k)$ から、第 $k$ 式 $(a_{kk}^{(k)} = 1)$ の $a_{kj}^{(k-1)}$ 倍を引けばよい。
すなわち、 $k = 1, 2, \cdots, n$ の順に

$$
\begin{array}{ll}
\text{ガウスの消去法の前進消去} \\
\quad a_{kk}^{(k)} = 1 \\
\quad a_{kj}^{(k)} = a_{kj}^{(k-1)} / a_{kk}^{(k-1)} & j > k \\
\quad b_{k}^{(k)} = b_{k}^{(k-1)} / a_{kk}^{(k-1)} \\
\quad a_{ik}^{(k)} = 0 & i > k \\
\quad a_{ij}^{(k)} = a_{ij}^{(k-1)} - a_{ik}^{(k-1)} a_{kj}^{(k)} & i > k, j > k \\
\quad b_{i}^{(k)} = b_{i}^{(k-1)} - a_{ik}^{(k-1)} b_{k}^{(k)} & i > k \\
\end{array} \tag{3.2}
$$

と係数と定数項を変化させると、対角要素はすべて $1$ になり、対角要素の下の要素はすべて $0$ になり、係数行列は上三角行列になる。
<!-- $(3.2)$ を PAD で表したものが、図 3.1 の 前進消去の部分である。
この PAD では、 $a_{ij}^{(k)}$ はすべての $k$ に対して同じ配列要素 `a(i,j)` に次々と上書きしている。
それは、 $a_{ij}^{(k)}$ が求められた後では $a_{ij}^{(k-1)}$ 以前の配列要素 `a(i,j)` の値を再び参照することはないからである。
また、 PAD では、対角要素 $1$ と下三角行列の $0$ はわかりきっているので、 $1$ にしたり $0$ にしたりする演算は行なっていない<sup>[$1)$](#note1)</sup> 。

 <small id="note1">$^{1)}$ $e_{n−1}(z)$ は $n − 1$ 次のラグランジュ補間多項式による $z^s$ の近似の誤差である。 $(5.53)$ 、 $(5.57)$ 参照。</small>
-->

$(3.2)$ の手順が完了したときには、連立1次方程式は、次の形に変形されている。

$$
\begin{aligned}
x_1 + a_{12}^{(1)} x_2 + a_{13}^{(1)} x_3 + \cdots + a_{1n-1}^{(1)} x_{n-1} + a_{1n}^{(1)} x_n & = b_1^{(1)} \\
x_2 + a_{23}^{(2)} x_3 + \cdots + a_{2n-1}^{(2)} x_{n-1} + a_{2n}^{(2)} x_n & = b_2^{(2)} \\
x_3 + \cdots + a_{3n-1}^{(3)} x_{n-1} + a_{3n}^{(3)} x_n & = b_3^{(3)} \\
\cdots \, \cdots \\
x_{n-1} + a_{n-1n}^{(n-1)} x_n & = b_{n-1}^{(n-1)} \\
x_n & = b_n^{(n)}
\end{aligned} \tag{3.2’}
$$
<!-- 
なお、 PAD では同じ 係数 $A$ を持つ $m$ 個の問題を一挙に解くことができるようにしてある。
そのために、定数項は係数の行列の $第 n + 1 列, n + 2 列, \cdots n + m
列$ に記憶させてある。
すなわち、第 $i$ 行は

$$
\begin{array}{}
a_{i\ n+1} = b_{i\ 1}, & a_{i\ n+2} = b_{i\ 2}, & \cdots & a_{i\ n+m} = b_{i\ m}
\end{array}
$$

である。
こうしておくと PAD 、したがって手順が簡単になる。
ピボット選択については後で述べる。
 -->
